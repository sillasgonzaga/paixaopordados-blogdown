<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Manipulando os dados | Ciência de Dados com R - Introdução</title>
  <meta name="description" content="Aprendendo a programar com R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Manipulando os dados | Ciência de Dados com R - Introdução" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Aprendendo a programar com R" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Manipulando os dados | Ciência de Dados com R - Introdução" />
  
  <meta name="twitter:description" content="Aprendendo a programar com R" />
  

<meta name="author" content="Saulo Guerra, Paulo Felipe de Oliveira, Robert McDonnell e Sillas Gonzaga" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lendo-os-dados.html"/>
<link rel="next" href="limpando-dados.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-61574597-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-61574597-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Ciência de Dados com R - Introdução</a></li>
<img src="hexcdr.png" class="hexcurso" alt="hex">

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html"><i class="fa fa-check"></i>Sobre os autores</a></li>
<li class="chapter" data-level="" data-path="download.html"><a href="download.html"><i class="fa fa-check"></i>Download</a></li>
<li class="chapter" data-level="1" data-path="introdução.html"><a href="introdução.html"><i class="fa fa-check"></i><b>1</b> Introdução</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introdução.html"><a href="introdução.html#o-que-é-ciência-de-dados"><i class="fa fa-check"></i><b>1.1</b> O que é Ciência de Dados?</a></li>
<li class="chapter" data-level="1.2" data-path="introdução.html"><a href="introdução.html#workflow-da-ciência-de-dados"><i class="fa fa-check"></i><b>1.2</b> Workflow da Ciência de Dados</a></li>
<li class="chapter" data-level="1.3" data-path="introdução.html"><a href="introdução.html#linguagens-para-ciência-de-dados"><i class="fa fa-check"></i><b>1.3</b> Linguagens para Ciência de dados</a></li>
<li class="chapter" data-level="1.4" data-path="introdução.html"><a href="introdução.html#o-que-é-r-e-por-que-devo-aprendê-lo"><i class="fa fa-check"></i><b>1.4</b> O que é R e por que devo aprendê-lo?</a></li>
<li class="chapter" data-level="1.5" data-path="introdução.html"><a href="introdução.html#rstudio"><i class="fa fa-check"></i><b>1.5</b> RStudio</a></li>
<li class="chapter" data-level="1.6" data-path="introdução.html"><a href="introdução.html#buscando-ajuda"><i class="fa fa-check"></i><b>1.6</b> Buscando Ajuda</a></li>
<li class="chapter" data-level="1.7" data-path="introdução.html"><a href="introdução.html#exercícios"><i class="fa fa-check"></i><b>1.7</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html"><i class="fa fa-check"></i><b>2</b> Conceitos Básicos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#console"><i class="fa fa-check"></i><b>2.1</b> Console</a></li>
<li class="chapter" data-level="2.2" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#scripts"><i class="fa fa-check"></i><b>2.2</b> Scripts</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#salvando-scripts"><i class="fa fa-check"></i><b>2.2.1</b> Salvando Scripts</a></li>
<li class="chapter" data-level="2.2.2" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#comentários-de-código"><i class="fa fa-check"></i><b>2.2.2</b> Comentários de Código</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#objetos-variáveis"><i class="fa fa-check"></i><b>2.3</b> Objetos (Variáveis)</a></li>
<li class="chapter" data-level="2.4" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#funções"><i class="fa fa-check"></i><b>2.4</b> Funções</a></li>
<li class="chapter" data-level="2.5" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#pacotes"><i class="fa fa-check"></i><b>2.5</b> Pacotes</a></li>
<li class="chapter" data-level="2.6" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#boas-práticas"><i class="fa fa-check"></i><b>2.6</b> Boas práticas</a></li>
<li class="chapter" data-level="2.7" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#tidyverse"><i class="fa fa-check"></i><b>2.7</b> Tidyverse</a></li>
<li class="chapter" data-level="2.8" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#exercícios-1"><i class="fa fa-check"></i><b>2.8</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html"><i class="fa fa-check"></i><b>3</b> Lendo os dados</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#tipos-de-estrutura-dos-dados"><i class="fa fa-check"></i><b>3.1</b> Tipos de Estrutura dos Dados</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#dados-estruturados"><i class="fa fa-check"></i><b>3.1.1</b> Dados Estruturados</a></li>
<li class="chapter" data-level="3.1.2" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#dados-não-estruturados"><i class="fa fa-check"></i><b>3.1.2</b> Dados Não Estruturados</a></li>
<li class="chapter" data-level="3.1.3" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#dados-semiestruturados"><i class="fa fa-check"></i><b>3.1.3</b> Dados Semiestruturados</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#definindo-o-local-dos-dados"><i class="fa fa-check"></i><b>3.2</b> Definindo o Local dos Dados</a></li>
<li class="chapter" data-level="3.3" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#pacote-para-leitura-dos-dados"><i class="fa fa-check"></i><b>3.3</b> Pacote para leitura dos dados</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html"><i class="fa fa-check"></i><b>4</b> Manipulando os dados</a>
<ul>
<li class="chapter" data-level="4.1" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#tipos-de-variáveis-e-colunas"><i class="fa fa-check"></i><b>4.1</b> Tipos de Variáveis e Colunas</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#conversões-de-tipos-de-variáveis"><i class="fa fa-check"></i><b>4.1.1</b> Conversões de tipos de variáveis</a></li>
<li class="chapter" data-level="4.1.2" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#outros-tipos-de-variáveis"><i class="fa fa-check"></i><b>4.1.2</b> Outros tipos de variáveis</a></li>
<li class="chapter" data-level="4.1.3" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#valores-faltantes-e-o-na"><i class="fa fa-check"></i><b>4.1.3</b> Valores faltantes e o ‘NA’</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#estruturas-de-controle-de-fluxo"><i class="fa fa-check"></i><b>4.2</b> Estruturas de Controle de Fluxo</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#if-e-else"><i class="fa fa-check"></i><b>4.2.1</b> If e Else</a></li>
<li class="chapter" data-level="4.2.2" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#loops"><i class="fa fa-check"></i><b>4.2.2</b> Loops</a></li>
<li class="chapter" data-level="4.2.3" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#funções-1"><i class="fa fa-check"></i><b>4.2.3</b> Funções</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#manipulações-com-r-base"><i class="fa fa-check"></i><b>4.3</b> Manipulações com R base</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#trabalhando-com-colunas-de-um-data.frame"><i class="fa fa-check"></i><b>4.3.1</b> Trabalhando com colunas de um data.frame</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#pacote-dplyr"><i class="fa fa-check"></i><b>4.4</b> Pacote dplyr</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#verbetes-do-dplyr-e-o-operador"><i class="fa fa-check"></i><b>4.4.1</b> Verbetes do dplyr e o operador <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#select"><i class="fa fa-check"></i><b>4.4.2</b> Select</a></li>
<li class="chapter" data-level="4.4.3" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#mutate"><i class="fa fa-check"></i><b>4.4.3</b> Mutate</a></li>
<li class="chapter" data-level="4.4.4" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#filter"><i class="fa fa-check"></i><b>4.4.4</b> Filter</a></li>
<li class="chapter" data-level="4.4.5" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#group-by-e-summarise"><i class="fa fa-check"></i><b>4.4.5</b> Group By e Summarise</a></li>
<li class="chapter" data-level="4.4.6" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#arrange"><i class="fa fa-check"></i><b>4.4.6</b> Arrange</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#exercícios-2"><i class="fa fa-check"></i><b>4.5</b> Exercícios</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#parte-1"><i class="fa fa-check"></i><b>4.5.1</b> Parte 1</a></li>
<li class="chapter" data-level="4.5.2" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#parte-2"><i class="fa fa-check"></i><b>4.5.2</b> Parte 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="limpando-dados.html"><a href="limpando-dados.html"><i class="fa fa-check"></i><b>5</b> Limpando dados</a>
<ul>
<li class="chapter" data-level="5.1" data-path="limpando-dados.html"><a href="limpando-dados.html#o-formato-ideal-dos-dados"><i class="fa fa-check"></i><b>5.1</b> O formato “ideal” dos dados</a></li>
<li class="chapter" data-level="5.2" data-path="limpando-dados.html"><a href="limpando-dados.html#pacote-tidyr"><i class="fa fa-check"></i><b>5.2</b> Pacote tidyr</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="limpando-dados.html"><a href="limpando-dados.html#pivot_longer"><i class="fa fa-check"></i><b>5.2.1</b> pivot_longer()</a></li>
<li class="chapter" data-level="5.2.2" data-path="limpando-dados.html"><a href="limpando-dados.html#pivot_wider"><i class="fa fa-check"></i><b>5.2.2</b> pivot_wider()</a></li>
<li class="chapter" data-level="5.2.3" data-path="limpando-dados.html"><a href="limpando-dados.html#separate"><i class="fa fa-check"></i><b>5.2.3</b> separate</a></li>
<li class="chapter" data-level="5.2.4" data-path="limpando-dados.html"><a href="limpando-dados.html#unite"><i class="fa fa-check"></i><b>5.2.4</b> unite</a></li>
<li class="chapter" data-level="5.2.5" data-path="limpando-dados.html"><a href="limpando-dados.html#separate_rows"><i class="fa fa-check"></i><b>5.2.5</b> separate_rows</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="limpando-dados.html"><a href="limpando-dados.html#exercicios"><i class="fa fa-check"></i><b>5.3</b> Exercicios</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="juntando-dados.html"><a href="juntando-dados.html"><i class="fa fa-check"></i><b>6</b> Juntando dados</a>
<ul>
<li class="chapter" data-level="6.1" data-path="juntando-dados.html"><a href="juntando-dados.html#união-de-dados-union"><i class="fa fa-check"></i><b>6.1</b> União de dados (Union)</a></li>
<li class="chapter" data-level="6.2" data-path="juntando-dados.html"><a href="juntando-dados.html#cruzamento-de-dados-join"><i class="fa fa-check"></i><b>6.2</b> Cruzamento de Dados (Join)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="juntando-dados.html"><a href="juntando-dados.html#inner-join-ou-apenas-join"><i class="fa fa-check"></i><b>6.2.1</b> Inner Join (ou apenas Join)</a></li>
<li class="chapter" data-level="6.2.2" data-path="juntando-dados.html"><a href="juntando-dados.html#left-outer-join"><i class="fa fa-check"></i><b>6.2.2</b> Left Outer Join</a></li>
<li class="chapter" data-level="6.2.3" data-path="juntando-dados.html"><a href="juntando-dados.html#right-outer-join"><i class="fa fa-check"></i><b>6.2.3</b> Right Outer Join</a></li>
<li class="chapter" data-level="6.2.4" data-path="juntando-dados.html"><a href="juntando-dados.html#full-outer-join"><i class="fa fa-check"></i><b>6.2.4</b> Full Outer Join</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="juntando-dados.html"><a href="juntando-dados.html#exercícios-3"><i class="fa fa-check"></i><b>6.3</b> Exercícios</a></li>
<li class="chapter" data-level="6.4" data-path="juntando-dados.html"><a href="juntando-dados.html#exercícios-gerais-do-tidyverse"><i class="fa fa-check"></i><b>6.4</b> Exercícios gerais do Tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html"><i class="fa fa-check"></i><b>7</b> Dados em strings (texto)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#pacote-stringr"><i class="fa fa-check"></i><b>7.1</b> Pacote stringr</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#extrair-parte-de-uma-string"><i class="fa fa-check"></i><b>7.1.1</b> Extrair parte de uma string</a></li>
<li class="chapter" data-level="7.1.2" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#substituir-caracteres-em-um-string"><i class="fa fa-check"></i><b>7.1.2</b> Substituir caracteres em um string</a></li>
<li class="chapter" data-level="7.1.3" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#buscar-correspondências-em-um-string"><i class="fa fa-check"></i><b>7.1.3</b> Buscar correspondências em um string</a></li>
<li class="chapter" data-level="7.1.4" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#complementar-uma-string"><i class="fa fa-check"></i><b>7.1.4</b> Complementar uma string</a></li>
<li class="chapter" data-level="7.1.5" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#remover-espaços-em-branco-desnecessários"><i class="fa fa-check"></i><b>7.1.5</b> Remover espaços em branco desnecessários</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#regex"><i class="fa fa-check"></i><b>7.2</b> Regex</a></li>
<li class="chapter" data-level="7.3" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#exercícios-4"><i class="fa fa-check"></i><b>7.3</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="trabalhando-com-datas.html"><a href="trabalhando-com-datas.html"><i class="fa fa-check"></i><b>8</b> Trabalhando com datas</a>
<ul>
<li class="chapter" data-level="8.1" data-path="trabalhando-com-datas.html"><a href="trabalhando-com-datas.html#gerar-um-vetor-sequencial-de-datas"><i class="fa fa-check"></i><b>8.1</b> Gerar um vetor sequencial de datas</a></li>
<li class="chapter" data-level="8.2" data-path="trabalhando-com-datas.html"><a href="trabalhando-com-datas.html#parsear-datas-e-horários"><i class="fa fa-check"></i><b>8.2</b> ‘Parsear’ datas e horários</a></li>
<li class="chapter" data-level="8.3" data-path="trabalhando-com-datas.html"><a href="trabalhando-com-datas.html#extrair-componentes-de-uma-data"><i class="fa fa-check"></i><b>8.3</b> Extrair componentes de uma data</a></li>
<li class="chapter" data-level="8.4" data-path="trabalhando-com-datas.html"><a href="trabalhando-com-datas.html#operações-matemáticas-com-datas"><i class="fa fa-check"></i><b>8.4</b> Operações matemáticas com datas</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="escrevendo-dados.html"><a href="escrevendo-dados.html"><i class="fa fa-check"></i><b>9</b> Escrevendo dados</a>
<ul>
<li class="chapter" data-level="9.1" data-path="escrevendo-dados.html"><a href="escrevendo-dados.html#escrevendo-csv"><i class="fa fa-check"></i><b>9.1</b> Escrevendo csv</a></li>
<li class="chapter" data-level="9.2" data-path="escrevendo-dados.html"><a href="escrevendo-dados.html#rds"><i class="fa fa-check"></i><b>9.2</b> Rds</a></li>
<li class="chapter" data-level="9.3" data-path="escrevendo-dados.html"><a href="escrevendo-dados.html#escrevendo-outros-tipos-de-arquivos"><i class="fa fa-check"></i><b>9.3</b> Escrevendo outros tipos de arquivos</a></li>
<li class="chapter" data-level="9.4" data-path="escrevendo-dados.html"><a href="escrevendo-dados.html#exercícios-5"><i class="fa fa-check"></i><b>9.4</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="obtendo-dados.html"><a href="obtendo-dados.html"><i class="fa fa-check"></i><b>10</b> Obtendo dados</a>
<ul>
<li class="chapter" data-level="10.1" data-path="obtendo-dados.html"><a href="obtendo-dados.html#api"><i class="fa fa-check"></i><b>10.1</b> API</a></li>
<li class="chapter" data-level="10.2" data-path="obtendo-dados.html"><a href="obtendo-dados.html#web-scrapping"><i class="fa fa-check"></i><b>10.2</b> Web Scrapping</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html"><i class="fa fa-check"></i><b>11</b> Estruturas complexas de dados</a>
<ul>
<li class="chapter" data-level="11.1" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#introdução-a-listas"><i class="fa fa-check"></i><b>11.1</b> Introdução a listas</a></li>
<li class="chapter" data-level="11.2" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#introdução-ao-pacote-purrr"><i class="fa fa-check"></i><b>11.2</b> Introdução ao pacote purrr</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#map"><i class="fa fa-check"></i><b>11.2.1</b> <code>map()</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#funções-derivadas-de-map"><i class="fa fa-check"></i><b>11.2.2</b> Funções derivadas de <code>map()</code></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#ideia-de-projeto-aplicando-uma-série-de-funções-a-uma-lista-de-arquivos"><i class="fa fa-check"></i><b>11.3</b> Ideia de projeto: Aplicando uma série de funções a uma lista de arquivos</a></li>
<li class="chapter" data-level="11.4" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#referências"><i class="fa fa-check"></i><b>11.4</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>12</b> Visualizações de dados (ggplot2)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ggplot2.html"><a href="ggplot2.html#dataset-do-módulo"><i class="fa fa-check"></i><b>12.1</b> Dataset do módulo</a></li>
<li class="chapter" data-level="12.2" data-path="ggplot2.html"><a href="ggplot2.html#mapeamento-estético"><i class="fa fa-check"></i><b>12.2</b> Mapeamento Estético</a></li>
<li class="chapter" data-level="12.3" data-path="ggplot2.html"><a href="ggplot2.html#objetos-geométricos-e-tipos-de-gráficos"><i class="fa fa-check"></i><b>12.3</b> Objetos geométricos e tipos de gráficos</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ggplot2.html"><a href="ggplot2.html#escolhendo-o-tipo-de-gráfico"><i class="fa fa-check"></i><b>12.3.1</b> Escolhendo o tipo de gráfico</a></li>
<li class="chapter" data-level="12.3.2" data-path="ggplot2.html"><a href="ggplot2.html#gráfico-de-dispersão-geom_point"><i class="fa fa-check"></i><b>12.3.2</b> Gráfico de Dispersão (<code>geom_point()</code>)</a></li>
<li class="chapter" data-level="12.3.3" data-path="ggplot2.html"><a href="ggplot2.html#gráficos-de-bolhas"><i class="fa fa-check"></i><b>12.3.3</b> Gráficos de Bolhas</a></li>
<li class="chapter" data-level="12.3.4" data-path="ggplot2.html"><a href="ggplot2.html#gráficos-de-barras"><i class="fa fa-check"></i><b>12.3.4</b> Gráficos de Barras</a></li>
<li class="chapter" data-level="12.3.5" data-path="ggplot2.html"><a href="ggplot2.html#gráficos-de-linhas"><i class="fa fa-check"></i><b>12.3.5</b> Gráficos de linhas</a></li>
<li class="chapter" data-level="12.3.6" data-path="ggplot2.html"><a href="ggplot2.html#histogramas"><i class="fa fa-check"></i><b>12.3.6</b> Histogramas</a></li>
<li class="chapter" data-level="12.3.7" data-path="ggplot2.html"><a href="ggplot2.html#boxplots-e-violinplots"><i class="fa fa-check"></i><b>12.3.7</b> Boxplots e violinplots</a></li>
<li class="chapter" data-level="12.3.8" data-path="ggplot2.html"><a href="ggplot2.html#textosrótulos"><i class="fa fa-check"></i><b>12.3.8</b> Textos/Rótulos</a></li>
<li class="chapter" data-level="12.3.9" data-path="ggplot2.html"><a href="ggplot2.html#anotações"><i class="fa fa-check"></i><b>12.3.9</b> Anotações</a></li>
<li class="chapter" data-level="12.3.10" data-path="ggplot2.html"><a href="ggplot2.html#cleveland-dot-plot"><i class="fa fa-check"></i><b>12.3.10</b> Cleveland Dot Plot</a></li>
<li class="chapter" data-level="12.3.11" data-path="ggplot2.html"><a href="ggplot2.html#mapas-de-calor"><i class="fa fa-check"></i><b>12.3.11</b> Mapas de calor</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ggplot2.html"><a href="ggplot2.html#escalas"><i class="fa fa-check"></i><b>12.4</b> Escalas</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="ggplot2.html"><a href="ggplot2.html#tipos-de-variáveis"><i class="fa fa-check"></i><b>12.4.1</b> Tipos de Variáveis</a></li>
<li class="chapter" data-level="12.4.2" data-path="ggplot2.html"><a href="ggplot2.html#eixos"><i class="fa fa-check"></i><b>12.4.2</b> Eixos</a></li>
<li class="chapter" data-level="12.4.3" data-path="ggplot2.html"><a href="ggplot2.html#escalas-de-cores-color-e-preenchimento-fill"><i class="fa fa-check"></i><b>12.4.3</b> Escalas de Cores (color) e Preenchimento (fill)</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="ggplot2.html"><a href="ggplot2.html#subplots-facet"><i class="fa fa-check"></i><b>12.5</b> Subplots (facet)</a></li>
<li class="chapter" data-level="12.6" data-path="ggplot2.html"><a href="ggplot2.html#temas"><i class="fa fa-check"></i><b>12.6</b> Temas</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="ggplot2.html"><a href="ggplot2.html#temas-disponíveis-no-ggplot2"><i class="fa fa-check"></i><b>12.6.1</b> Temas disponíveis no ggplot2</a></li>
<li class="chapter" data-level="12.6.2" data-path="ggplot2.html"><a href="ggplot2.html#temas-no-pacote-ggthemes"><i class="fa fa-check"></i><b>12.6.2</b> Temas no pacote ggthemes</a></li>
<li class="chapter" data-level="12.6.3" data-path="ggplot2.html"><a href="ggplot2.html#setando-o-tema-globalmente"><i class="fa fa-check"></i><b>12.6.3</b> Setando o tema globalmente</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="ggplot2.html"><a href="ggplot2.html#legendas"><i class="fa fa-check"></i><b>12.7</b> Legendas</a></li>
<li class="chapter" data-level="12.8" data-path="ggplot2.html"><a href="ggplot2.html#mapas-plotando-polígonos"><i class="fa fa-check"></i><b>12.8</b> Mapas: plotando polígonos</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="ggplot2.html"><a href="ggplot2.html#projeto-plotando-indicadores-socioeconômicos-em-um-mapa."><i class="fa fa-check"></i><b>12.8.1</b> Projeto: plotando indicadores socioeconômicos em um mapa.</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="ggplot2.html"><a href="ggplot2.html#salvando-gráficos"><i class="fa fa-check"></i><b>12.9</b> Salvando Gráficos</a></li>
<li class="chapter" data-level="12.10" data-path="ggplot2.html"><a href="ggplot2.html#extensões-do-ggplot2"><i class="fa fa-check"></i><b>12.10</b> Extensões do ggplot2</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="ggplot2.html"><a href="ggplot2.html#ggrepel"><i class="fa fa-check"></i><b>12.10.1</b> ggrepel</a></li>
<li class="chapter" data-level="12.10.2" data-path="ggplot2.html"><a href="ggplot2.html#gganimate"><i class="fa fa-check"></i><b>12.10.2</b> gganimate</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="ggplot2.html"><a href="ggplot2.html#exercícios-6"><i class="fa fa-check"></i><b>12.11</b> Exercícios</a>
<ul>
<li class="chapter" data-level="12.11.1" data-path="ggplot2.html"><a href="ggplot2.html#parte-1-1"><i class="fa fa-check"></i><b>12.11.1</b> Parte 1</a></li>
<li class="chapter" data-level="12.11.2" data-path="ggplot2.html"><a href="ggplot2.html#parte-2-1"><i class="fa fa-check"></i><b>12.11.2</b> Parte 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="htmlwidgets.html"><a href="htmlwidgets.html"><i class="fa fa-check"></i><b>13</b> Visualizações Interativas</a>
<ul>
<li class="chapter" data-level="13.1" data-path="htmlwidgets.html"><a href="htmlwidgets.html#introdução-1"><i class="fa fa-check"></i><b>13.1</b> Introdução</a></li>
<li class="chapter" data-level="13.2" data-path="htmlwidgets.html"><a href="htmlwidgets.html#plotly"><i class="fa fa-check"></i><b>13.2</b> Plotly</a></li>
<li class="chapter" data-level="13.3" data-path="htmlwidgets.html"><a href="htmlwidgets.html#dygraphs"><i class="fa fa-check"></i><b>13.3</b> dygraphs</a></li>
<li class="chapter" data-level="13.4" data-path="htmlwidgets.html"><a href="htmlwidgets.html#leaflet"><i class="fa fa-check"></i><b>13.4</b> Leaflet</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="htmlwidgets.html"><a href="htmlwidgets.html#primeiro-exemplo"><i class="fa fa-check"></i><b>13.4.1</b> Primeiro exemplo</a></li>
<li class="chapter" data-level="13.4.2" data-path="htmlwidgets.html"><a href="htmlwidgets.html#marcadores"><i class="fa fa-check"></i><b>13.4.2</b> Marcadores</a></li>
<li class="chapter" data-level="13.4.3" data-path="htmlwidgets.html"><a href="htmlwidgets.html#polígonos"><i class="fa fa-check"></i><b>13.4.3</b> Polígonos</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="htmlwidgets.html"><a href="htmlwidgets.html#exercícios-7"><i class="fa fa-check"></i><b>13.5</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>14</b> RMarkdown</a>
<ul>
<li class="chapter" data-level="14.1" data-path="rmarkdown.html"><a href="rmarkdown.html#usos-do-rmarkdown"><i class="fa fa-check"></i><b>14.1</b> Usos do RMarkdown</a></li>
<li class="chapter" data-level="14.2" data-path="rmarkdown.html"><a href="rmarkdown.html#estrutura-de-um-rmarkdown"><i class="fa fa-check"></i><b>14.2</b> Estrutura de um RMarkdown</a></li>
<li class="chapter" data-level="14.3" data-path="rmarkdown.html"><a href="rmarkdown.html#renderizando-um-documento"><i class="fa fa-check"></i><b>14.3</b> Renderizando um documento</a></li>
<li class="chapter" data-level="14.4" data-path="rmarkdown.html"><a href="rmarkdown.html#sintaxe"><i class="fa fa-check"></i><b>14.4</b> Sintaxe</a></li>
<li class="chapter" data-level="14.5" data-path="rmarkdown.html"><a href="rmarkdown.html#section"><i class="fa fa-check"></i><b>14.5</b> ***</a></li>
<li class="chapter" data-level="14.6" data-path="rmarkdown.html"><a href="rmarkdown.html#opções-de-chunk"><i class="fa fa-check"></i><b>14.6</b> Opções de Chunk</a></li>
<li class="chapter" data-level="14.7" data-path="rmarkdown.html"><a href="rmarkdown.html#principais-formatos"><i class="fa fa-check"></i><b>14.7</b> Principais Formatos</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="rmarkdown.html"><a href="rmarkdown.html#html"><i class="fa fa-check"></i><b>14.7.1</b> HTML</a></li>
<li class="chapter" data-level="14.7.2" data-path="rmarkdown.html"><a href="rmarkdown.html#pdf"><i class="fa fa-check"></i><b>14.7.2</b> PDF</a></li>
<li class="chapter" data-level="14.7.3" data-path="rmarkdown.html"><a href="rmarkdown.html#word"><i class="fa fa-check"></i><b>14.7.3</b> Word</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="rmarkdown.html"><a href="rmarkdown.html#excercícios"><i class="fa fa-check"></i><b>14.8</b> Excercícios</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="modelos.html"><a href="modelos.html"><i class="fa fa-check"></i><b>15</b> Modelos</a>
<ul>
<li class="chapter" data-level="15.1" data-path="modelos.html"><a href="modelos.html#modelo-linear"><i class="fa fa-check"></i><b>15.1</b> Modelo Linear</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="modelos.html"><a href="modelos.html#regressão"><i class="fa fa-check"></i><b>15.1.1</b> Regressão</a></li>
<li class="chapter" data-level="15.1.2" data-path="modelos.html"><a href="modelos.html#classificação"><i class="fa fa-check"></i><b>15.1.2</b> Classificação</a></li>
<li class="chapter" data-level="15.1.3" data-path="modelos.html"><a href="modelos.html#classificação-com-modelos-baseados-em-árvores"><i class="fa fa-check"></i><b>15.1.3</b> Classificação com modelos baseados em árvores</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="modelos.html"><a href="modelos.html#exercícios-8"><i class="fa fa-check"></i><b>15.2</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="revisão-titanic.html"><a href="revisão-titanic.html"><i class="fa fa-check"></i><b>16</b> Revisão - Titanic</a>
<ul>
<li class="chapter" data-level="16.1" data-path="revisão-titanic.html"><a href="revisão-titanic.html#objetivo"><i class="fa fa-check"></i><b>16.1</b> Objetivo</a></li>
<li class="chapter" data-level="16.2" data-path="revisão-titanic.html"><a href="revisão-titanic.html#carregando-os-dados"><i class="fa fa-check"></i><b>16.2</b> Carregando os Dados</a></li>
<li class="chapter" data-level="16.3" data-path="revisão-titanic.html"><a href="revisão-titanic.html#manipulando-os-dados-1"><i class="fa fa-check"></i><b>16.3</b> Manipulando os dados</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="revisão-titanic.html"><a href="revisão-titanic.html#variável-survived"><i class="fa fa-check"></i><b>16.3.1</b> Variável Survived</a></li>
<li class="chapter" data-level="16.3.2" data-path="revisão-titanic.html"><a href="revisão-titanic.html#variável-name"><i class="fa fa-check"></i><b>16.3.2</b> Variável Name</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="revisão-titanic.html"><a href="revisão-titanic.html#idade"><i class="fa fa-check"></i><b>16.4</b> Idade</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="revisão-titanic.html"><a href="revisão-titanic.html#exercício"><i class="fa fa-check"></i><b>16.4.1</b> Exercício</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="revisão-titanic.html"><a href="revisão-titanic.html#visualizações"><i class="fa fa-check"></i><b>16.5</b> Visualizações</a></li>
<li class="chapter" data-level="16.6" data-path="revisão-titanic.html"><a href="revisão-titanic.html#modelo-preditivo"><i class="fa fa-check"></i><b>16.6</b> Modelo Preditivo</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="referências-1.html"><a href="referências-1.html"><i class="fa fa-check"></i><b>17</b> Referências</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado com bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ciência de Dados com R - Introdução</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="manipulando-os-dados" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Manipulando os dados</h1>
<p>Neste capítulo, usaremos estes pacotes:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="manipulando-os-dados.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb35-2"><a href="manipulando-os-dados.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Após obter uma boa fonte de dados, e carregá-los para poder trabalhá-los no R, você certamente precisará realizar algumas limpezas e manipulações para que os dados estejam no ponto ideal para as fases finais de uma análise: execução de modelos econométricos, visualizações de dados, tabelas agregadas, relatórios etc. A realidade é que, na prática, os dados nunca estarão do jeito que você de fato precisa. Portanto, é fundamental dominar técnicas de manipulação de dados.</p>
<p>Entendamos a manipulação de dados como o ato de transformar, reestruturar, limpar, agregar e juntar os dados. Para se ter uma noção da importância dessa fase, alguns estudiosos da área de Ciência de Dados costumam afirmar que 80% do trabalho é encontrar uma boa fonte de dados, limpar e preparar os dados, sendo que os 20% restantes seriam o trabalho de aplicar modelos e realizar alguma análise propriamente dita.</p>
<blockquote>
<p>80% of data analysis is spent on the process of cleaning and preparing the data (Dasu and Johnson, 2003).</p>
</blockquote>
<blockquote>
<p>Data preparation is not just a first step, but must be repeated many over the course of analysis as new problems come to light or new data is collected (Hadley Wickham).</p>
</blockquote>
<div id="tipos-de-variáveis-e-colunas" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Tipos de Variáveis e Colunas</h2>
<p>Existem diversos tipos de objetos, e cada tipo “armazena” um conteúdo diferente, desde tabelas de dados recém-carregados a textos, números, ou simplesmente a afirmação de verdadeiro ou falso (Boleano).</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="manipulando-os-dados.html#cb36-1" aria-hidden="true" tabindex="-1"></a>inteiro <span class="ot">&lt;-</span> <span class="dv">928</span></span>
<span id="cb36-2"><a href="manipulando-os-dados.html#cb36-2" aria-hidden="true" tabindex="-1"></a>outro.inteiro <span class="ot">&lt;-</span> <span class="fl">5e2</span></span>
<span id="cb36-3"><a href="manipulando-os-dados.html#cb36-3" aria-hidden="true" tabindex="-1"></a>decimal <span class="ot">&lt;-</span> <span class="fl">182.93</span></span>
<span id="cb36-4"><a href="manipulando-os-dados.html#cb36-4" aria-hidden="true" tabindex="-1"></a>caracter <span class="ot">&lt;-</span> <span class="st">&#39;exportação&#39;</span></span>
<span id="cb36-5"><a href="manipulando-os-dados.html#cb36-5" aria-hidden="true" tabindex="-1"></a>logico <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb36-6"><a href="manipulando-os-dados.html#cb36-6" aria-hidden="true" tabindex="-1"></a>outro.logico <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
<p>Repare nas atribuições acima. Usaremos a função <code>class()</code> para ver o tipo de cada uma:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="manipulando-os-dados.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(inteiro)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="manipulando-os-dados.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(outro.inteiro)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="manipulando-os-dados.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(decimal)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="manipulando-os-dados.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(caracter)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="manipulando-os-dados.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(logico)</span></code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="manipulando-os-dados.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(outro.logico)</span></code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<p>Esses são alguns dos tipos básicos de objetos/variáveis no R. Para valores inteiros ou decimais, <code>numeric</code> , <code>character</code> para valores textuais e <code>logical</code> para valores lógicos (verdadeiro ou falso). Existe também o tipo <code>integer</code>, que representa apenas números inteiros, sem decimais, porém, na maioria das vezes, o R interpreta o <code>integer</code> como <code>numeric</code>, pois o <code>integer</code> também é um <code>numeric</code>.</p>
<p>Além dos tipos básicos, existem também os tipos “complexos,” que são <code>vector</code>, <code>array</code>, <code>matrix</code>, <code>list</code>, <code>data.frame</code> e <code>factor</code>.</p>
<p>Data frame é, provavelmente, o tipo de dado complexo mais utilizado em R. É nele que você armazena conjuntos de dados estruturados em linhas e colunas. Um data frame possui colunas nomeadas, sendo que todas as colunas possuem a mesma quantidade de linhas. Imagine o <code>dataframe</code> como uma tabela.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="manipulando-os-dados.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df)</span></code></pre></div>
<pre><code>## [1] &quot;spec_tbl_df&quot; &quot;tbl_df&quot;      &quot;tbl&quot;         &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="manipulando-os-dados.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code></pre></div>
<pre><code>## [1] 144367     31</code></pre>
<p>Percebeu o termo <code>tbl</code> no output acima? Significa <code>tibble()</code>, que, conforme o próprio pacote chamado <code>tibble</code> descreve, corresponde a uma moderna implementação da estrutura <code>data.frame</code>. A classe <code>tibble</code> não possui algumas deficiências da classe <code>data.frame</code>, por isso a usaremos sempre que possui. É muito simples transformar um <code>data.frame</code> em <code>tibble</code>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="manipulando-os-dados.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># carregando um dataset pronto do R</span></span>
<span id="cb53-2"><a href="manipulando-os-dados.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb53-3"><a href="manipulando-os-dados.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># verificando a classe</span></span>
<span id="cb53-4"><a href="manipulando-os-dados.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(iris)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="manipulando-os-dados.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transformando para tibble</span></span>
<span id="cb55-2"><a href="manipulando-os-dados.html#cb55-2" aria-hidden="true" tabindex="-1"></a>iris_tbl <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris)</span>
<span id="cb55-3"><a href="manipulando-os-dados.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># verificando a classe do novo objeto</span></span>
<span id="cb55-4"><a href="manipulando-os-dados.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(iris_tbl)</span></code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>Imprima no seu console os dois objetos e note a diferença:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="manipulando-os-dados.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(iris)</span>
<span id="cb57-2"><a href="manipulando-os-dados.html#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="manipulando-os-dados.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(iris_tbl)</span></code></pre></div>
<p>Outro tipo que já utilizamos bastante até agora, mas que não foi detalhado, é o <code>vector</code>, ou vetor. Vetores são sequências unidimensionais de valores de um mesmo tipo:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="manipulando-os-dados.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#faça as seguintes atribuições</span></span>
<span id="cb58-2"><a href="manipulando-os-dados.html#cb58-2" aria-hidden="true" tabindex="-1"></a>vetor.chr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;tipo1&#39;</span>, <span class="st">&#39;tipo2&#39;</span>, <span class="st">&#39;tipo3&#39;</span>, <span class="st">&#39;tipo4&#39;</span>)</span>
<span id="cb58-3"><a href="manipulando-os-dados.html#cb58-3" aria-hidden="true" tabindex="-1"></a>vetor.num <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">1001</span>)</span>
<span id="cb58-4"><a href="manipulando-os-dados.html#cb58-4" aria-hidden="true" tabindex="-1"></a>vetor.num.repetidos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">50</span>)) <span class="co">#usando funcão para repetir números</span></span>
<span id="cb58-5"><a href="manipulando-os-dados.html#cb58-5" aria-hidden="true" tabindex="-1"></a>vetor.num.sequencia <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">100</span>, <span class="at">by=</span><span class="dv">5</span>)) <span class="co">#usando função para criar sequências</span></span>
<span id="cb58-6"><a href="manipulando-os-dados.html#cb58-6" aria-hidden="true" tabindex="-1"></a>vetor.logical <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb58-7"><a href="manipulando-os-dados.html#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="do">##veja o conteúdo das variáveis</span></span>
<span id="cb58-8"><a href="manipulando-os-dados.html#cb58-8" aria-hidden="true" tabindex="-1"></a>vetor.chr</span></code></pre></div>
<pre><code>## [1] &quot;tipo1&quot; &quot;tipo2&quot; &quot;tipo3&quot; &quot;tipo4&quot;</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="manipulando-os-dados.html#cb60-1" aria-hidden="true" tabindex="-1"></a>vetor.num</span></code></pre></div>
<pre><code>## [1]    1    2    5    8 1001</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="manipulando-os-dados.html#cb62-1" aria-hidden="true" tabindex="-1"></a>vetor.num.repetidos</span></code></pre></div>
<pre><code>##  [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="manipulando-os-dados.html#cb64-1" aria-hidden="true" tabindex="-1"></a>vetor.num.sequencia</span></code></pre></div>
<pre><code>##  [1]   0   5  10  15  20  25  30  35  40  45  50  55  60  65  70  75  80  85  90  95 100</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="manipulando-os-dados.html#cb66-1" aria-hidden="true" tabindex="-1"></a>vetor.logical</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<p>Para a criação de vetores, usamos a função de combinação de valores <code>c()</code> (combine). Esta função vai combinar todos os parâmetros em um único vetor. Lembre-se: vetores são sequências que contêm apenas um tipo de dado.</p>
<p>Conhecendo o <code>data.frame</code> e o <code>vector</code>, você será capaz de entender como os dois se relacionam. Cada coluna de um data frame é um vetor. Um data frame pode ter colunas de diferentes tipos, mas cada coluna só pode ter registros de um único tipo.</p>
<p>Ficará mais claro a seguir. Veja como se cria um <code>data.frame</code>:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="manipulando-os-dados.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cria-se diferentes vetores</span></span>
<span id="cb68-2"><a href="manipulando-os-dados.html#cb68-2" aria-hidden="true" tabindex="-1"></a>nome <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;João&#39;</span>, <span class="st">&#39;José&#39;</span>, <span class="st">&#39;Maria&#39;</span>, <span class="st">&#39;Joana&#39;</span>)</span>
<span id="cb68-3"><a href="manipulando-os-dados.html#cb68-3" aria-hidden="true" tabindex="-1"></a>idade <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">12</span>, <span class="dv">28</span>, <span class="dv">31</span>)</span>
<span id="cb68-4"><a href="manipulando-os-dados.html#cb68-4" aria-hidden="true" tabindex="-1"></a>adulto <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb68-5"><a href="manipulando-os-dados.html#cb68-5" aria-hidden="true" tabindex="-1"></a>uf <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;DF&#39;</span>, <span class="st">&#39;SP&#39;</span>, <span class="st">&#39;RJ&#39;</span>, <span class="st">&#39;MG&#39;</span>)</span>
<span id="cb68-6"><a href="manipulando-os-dados.html#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">#cada vetor é uma combinação de elementos de um MESMO tipo de dados</span></span>
<span id="cb68-7"><a href="manipulando-os-dados.html#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co">#sendo assim, cada vetor pode ser uma coluna de um data.frame</span></span>
<span id="cb68-8"><a href="manipulando-os-dados.html#cb68-8" aria-hidden="true" tabindex="-1"></a>clientes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(nome, idade, adulto, uf)</span>
<span id="cb68-9"><a href="manipulando-os-dados.html#cb68-9" aria-hidden="true" tabindex="-1"></a>clientes</span></code></pre></div>
<pre><code>##    nome idade adulto uf
## 1  João    45   TRUE DF
## 2  José    12  FALSE SP
## 3 Maria    28   TRUE RJ
## 4 Joana    31   TRUE MG</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="manipulando-os-dados.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(clientes)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4 obs. of  4 variables:
##  $ nome  : chr  &quot;João&quot; &quot;José&quot; &quot;Maria&quot; &quot;Joana&quot;
##  $ idade : num  45 12 28 31
##  $ adulto: logi  TRUE FALSE TRUE TRUE
##  $ uf    : chr  &quot;DF&quot; &quot;SP&quot; &quot;RJ&quot; &quot;MG&quot;</code></pre>
<div id="conversões-de-tipos-de-variáveis" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Conversões de tipos de variáveis</h3>
<p>Quando é feito o carregamento de algum arquivo de dados no R, ele tenta “deduzir” os tipos de dados de cada coluna. Nem sempre essa dedução sai correta e, eventualmente, você precisará converter de um tipo para o outro. O R tem algumas funções para fazer essas conversões.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="manipulando-os-dados.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="st">&quot;2015&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="manipulando-os-dados.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="st">&quot;2015&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 2015</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="manipulando-os-dados.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="dv">55</span>)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="manipulando-os-dados.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="dv">55</span>)</span></code></pre></div>
<pre><code>## [1] &quot;55&quot;</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="manipulando-os-dados.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fl">3.14</span>)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="manipulando-os-dados.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.integer</span>(<span class="fl">3.14</span>)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="manipulando-os-dados.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="manipulando-os-dados.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="manipulando-os-dados.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.logical</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="manipulando-os-dados.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.logical</span>(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>O R também tenta “forçar a barra,” às vezes, para te ajudar. Quando você faz uma operação entre dois tipos diferentes, ele tenta fazer algo chamado <strong>coerção de tipos</strong>, ou seja, ele tenta converter os dados para que a operação faça sentido. Caso o R não consiga fazer a coerção, ele vai mostrar uma mensagem de erro.</p>
<p>Experimente os comandos a seguir no console:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="manipulando-os-dados.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="sc">+</span> <span class="cn">TRUE</span></span>
<span id="cb92-2"><a href="manipulando-os-dados.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2015</span> <span class="sc">&gt;</span> <span class="st">&quot;2016&quot;</span></span>
<span id="cb92-3"><a href="manipulando-os-dados.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;2014&quot;</span> <span class="sc">&lt;</span> <span class="dv">2017</span></span>
<span id="cb92-4"><a href="manipulando-os-dados.html#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># em alguns casos a coerção irá falhar ou dar resultado indesejado</span></span>
<span id="cb92-5"><a href="manipulando-os-dados.html#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="sc">&gt;</span> <span class="st">&quot;100&quot;</span></span>
<span id="cb92-6"><a href="manipulando-os-dados.html#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;6&quot;</span> <span class="sc">&lt;</span> <span class="dv">5</span></span>
<span id="cb92-7"><a href="manipulando-os-dados.html#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span> <span class="st">&quot;1&quot;</span></span></code></pre></div>
<p>Recomendamos fortemente que sempre se realize as conversões explicitamente com as funções apropriadas ao invés de confiar na coerção do R, a não ser que se tenha certeza do resultado.</p>
</div>
<div id="outros-tipos-de-variáveis" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Outros tipos de variáveis</h3>
<p>Existem outros tipos de variáveis bastante utilizados. Citaremos alguns deles, pois nesse curso utilizaremos muito pouco os demais tipos.</p>
<table>
<colgroup>
<col width="18%" />
<col width="25%" />
<col width="18%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th>Tipo</th>
<th align="left">Descrição</th>
<th>Dimensões</th>
<th>Homogêneo</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>vector</strong></td>
<td align="left">Coleção de elementos simples. Todos os elementos precisam ser do mesmo tipo básico de dado</td>
<td>1</td>
<td>Sim</td>
<td></td>
</tr>
<tr class="even">
<td><strong>array</strong></td>
<td align="left">Coleção que se parece com o vector, mas é multidimensional</td>
<td>n</td>
<td>Sim</td>
<td></td>
</tr>
<tr class="odd">
<td><strong>matrix</strong></td>
<td align="left">Tipo especial de array com duas dimensões</td>
<td>2</td>
<td>Sim</td>
<td></td>
</tr>
<tr class="even">
<td><strong>list</strong></td>
<td align="left">Objeto complexo com elementos que podem ser de diferentes tipos</td>
<td>1</td>
<td>Não</td>
<td></td>
</tr>
<tr class="odd">
<td><strong>data.frame</strong></td>
<td align="left">Tipo especial de lista, onde cada coluna é um vetor de apenas um tipo e todas as colunas têm o mesmo número de registros. É o tipo mais utilizado para se trabalhar com dados</td>
<td>2</td>
<td>Não</td>
<td></td>
</tr>
<tr class="even">
<td><strong>factor</strong></td>
<td align="left">Tipo especial de vector, que só contém valores predefinidos (levels) e categóricos (characters). Não é possível adicionar novas categorias sem criação de novos levels</td>
<td>1</td>
<td>Não</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="valores-faltantes-e-o-na" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Valores faltantes e o ‘NA’</h3>
<p>Em casos onde não existe valor em uma coluna de uma linha, o R atribui <code>NA</code>. É muito comum lidar com conjuntos de dados que tenham ocorrências de <code>NA</code> em alguns campos. É importante saber o que se fazer em casos de <code>NA</code>, e nem sempre a solução será a mesma: varia de acordo com as suas necessidades.</p>
<p>Em algumas bases de dados, quem gera o dado atribui valores genéricos como <code>999</code> ou até mesmo um “texto vazio,” <code>' '</code>. Neste caso, você provavelmente terá que substituir esses valores “omissos” por <code>NA</code>. Imputar dados em casos de <code>NA</code> é uma das várias estratégias para lidar-se com ocorrência de missing no conjunto dos dados.</p>
<p>Seguem algumas funções úteis para lidar-se com <code>NA</code>:</p>
<ul>
<li>A função <code>summary()</code> pode ser usada para averiguar a ocorrência de <code>NA</code>.</li>
<li>A função <code>is.na()</code> realiza um teste para saber se a variável/coluna possui um valor <code>NA</code>. retorna TRUE se for <code>NA</code> e FALSE se não for.</li>
<li>A função <code>complete.cases()</code> retorna TRUE para as linhas em que todas as colunas possuem valores válidos (preenchidos) e FALSE para as linhas em que, em alguma coluna, existe um <code>NA</code>. Ou seja, esta função diz quais são as linhas (amostras) completas em todas as suas características (campos).</li>
<li>Algumas funções possuem o argumento <code>na.rm</code>, ou semelhantes, para desconsiderar <code>NA</code> no cálculo. É o caso da função <code>mean()</code> ou <code>sum()</code>.</li>
</ul>
<p>Por exemplo:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="manipulando-os-dados.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;airquality&quot;</span>) <span class="co"># carrega uma base de dados pré-carregada no R</span></span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="manipulando-os-dados.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(airquality) <span class="co"># verificando ocorrência de NA</span></span></code></pre></div>
<pre><code>##      Ozone           Solar.R           Wind             Temp           Month            Day      
##  Min.   :  1.00   Min.   :  7.0   Min.   : 1.700   Min.   :56.00   Min.   :5.000   Min.   : 1.0  
##  1st Qu.: 18.00   1st Qu.:115.8   1st Qu.: 7.400   1st Qu.:72.00   1st Qu.:6.000   1st Qu.: 8.0  
##  Median : 31.50   Median :205.0   Median : 9.700   Median :79.00   Median :7.000   Median :16.0  
##  Mean   : 42.13   Mean   :185.9   Mean   : 9.958   Mean   :77.88   Mean   :6.993   Mean   :15.8  
##  3rd Qu.: 63.25   3rd Qu.:258.8   3rd Qu.:11.500   3rd Qu.:85.00   3rd Qu.:8.000   3rd Qu.:23.0  
##  Max.   :168.00   Max.   :334.0   Max.   :20.700   Max.   :97.00   Max.   :9.000   Max.   :31.0  
##  NA&#39;s   :37       NA&#39;s   :7</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="manipulando-os-dados.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(airquality<span class="sc">$</span>Ozone)</span></code></pre></div>
<pre><code>##   [1] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [21] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE
##  [41] FALSE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [61]  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE
##  [81] FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [101] FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE
## [121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [141] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE</code></pre>
</div>
</div>
<div id="estruturas-de-controle-de-fluxo" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Estruturas de Controle de Fluxo</h2>
<p>Para auxiliar no processo de manipulação de dados, você eventualmente precisará de algumas técnicas e estruturas de controle de fluxo. Estruturas para controle de fluxo nada mais são do que loops e condições. São estruturas fundamentais para qualquer linguagem de programação.</p>
<div id="if-e-else" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> If e Else</h3>
<p>A estrutura condicional é algo bastante intuitivo. A estrutura de if (se) e else (então) usa os operadores lógicos apresentados anteriormente. Se a condição do <code>if()</code> for verdadeira, executa-se uma tarefa específica, se for falsa, executa-se uma tarefa diferente. A estrutura parece algo do tipo:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="manipulando-os-dados.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>( variavel <span class="sc">&gt;=</span> <span class="dv">500</span> ) {</span>
<span id="cb98-2"><a href="manipulando-os-dados.html#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#executa uma tarefa se operação resultar TRUE</span></span>
<span id="cb98-3"><a href="manipulando-os-dados.html#cb98-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb98-4"><a href="manipulando-os-dados.html#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#executa outra tarefa se operação resultar FALSE</span></span>
<span id="cb98-5"><a href="manipulando-os-dados.html#cb98-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Da mesma forma, existe uma função que gera o mesmo resultado, o <code>ifelse()</code> (e uma do pacote <code>dplyr</code>, o <code>if_else()</code>).</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="manipulando-os-dados.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(variavel <span class="sc">&gt;=</span> <span class="dv">500</span>, <span class="st">&#39;executa essa tarefa se TRUE&#39;</span>, <span class="st">&#39;executa outra se FALSE&#39;</span>)</span></code></pre></div>
<p>Existe uma diferença entre as duas formas de “if else”: a estrutura <code>if() {} else {}</code> só opera variáveis, uma por uma, já a estrutura <code>ifelse()</code> opera vetores, ou seja, consegue fazer a comparação para todos os elementos. Isso faz com que a forma <code>if() {} else {}</code> seja mais utilizada para comparações fora dos dados, com variáveis avulsas. Já a estrutura <code>ifelse()</code> é mais usada para comparações dentro dos dados, com colunas, vetores e linhas.</p>
<p>Qualquer uma dessas estruturas pode ser “aninhada,” ou seja, encadeada. Por exemplo:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="manipulando-os-dados.html#cb100-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">9823</span></span>
<span id="cb100-2"><a href="manipulando-os-dados.html#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="manipulando-os-dados.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(a <span class="sc">&gt;=</span> <span class="dv">10000</span>) {</span>
<span id="cb100-4"><a href="manipulando-os-dados.html#cb100-4" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="st">&#39;VALOR ALTO&#39;</span></span>
<span id="cb100-5"><a href="manipulando-os-dados.html#cb100-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(a <span class="sc">&lt;</span> <span class="dv">10000</span> <span class="sc">&amp;</span> a <span class="sc">&gt;=</span> <span class="dv">1000</span>) {</span>
<span id="cb100-6"><a href="manipulando-os-dados.html#cb100-6" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="st">&#39;VALOR MEDIO&#39;</span> </span>
<span id="cb100-7"><a href="manipulando-os-dados.html#cb100-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(a <span class="sc">&lt;</span> <span class="dv">1000</span>) {</span>
<span id="cb100-8"><a href="manipulando-os-dados.html#cb100-8" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="st">&#39;VALOR BAIXO&#39;</span></span>
<span id="cb100-9"><a href="manipulando-os-dados.html#cb100-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb100-10"><a href="manipulando-os-dados.html#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="manipulando-os-dados.html#cb100-11" aria-hidden="true" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>## [1] &quot;VALOR MEDIO&quot;</code></pre>
<p>Ou ainda:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="manipulando-os-dados.html#cb102-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">839</span></span>
<span id="cb102-2"><a href="manipulando-os-dados.html#cb102-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(a <span class="sc">&gt;=</span> <span class="dv">10000</span>, <span class="st">&#39;VALOR ALTO&#39;</span>, <span class="fu">ifelse</span>(a <span class="sc">&lt;</span> <span class="dv">10000</span> <span class="sc">&amp;</span> a <span class="sc">&gt;=</span> <span class="dv">1000</span>, <span class="st">&#39;VALOR MEDIO&#39;</span>, <span class="st">&#39;VALOR BAIXO&#39;</span>))</span>
<span id="cb102-3"><a href="manipulando-os-dados.html#cb102-3" aria-hidden="true" tabindex="-1"></a>c</span></code></pre></div>
<pre><code>## [1] &quot;VALOR BAIXO&quot;</code></pre>
</div>
<div id="loops" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Loops</h3>
<p>Trata-se de um dos conceitos mais importantes de qualquer linguagem de programação, em R não é diferente. Loops (ou laços) repetem uma sequência de comando quantas vezes você desejar, ou até que uma condição aconteça, variando-se alguns aspectos entre uma repetição e outra.</p>
<p>Supondo que você tenha que ler 400 arquivos de dados que você obteve de um cliente. Você vai escrever 400 vezes a funcão de leitura? Nesse caso, basta fazer um loop para percorrer todos os arquivos da pasta e ler um por um com a função de leitura.</p>
<div id="for" class="section level4" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> For</h4>
<p>O <code>for()</code> é usado para realizar uma série de ordens para uma determinada sequência ou índices (vetor). Sua sintaxe é bem simples:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="manipulando-os-dados.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)) {</span>
<span id="cb104-2"><a href="manipulando-os-dados.html#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb104-3"><a href="manipulando-os-dados.html#cb104-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] 4
## [1] 9
## [1] 16
## [1] 25</code></pre>
<p>Para cada valor (chamamos esse valor de <code>i</code>) dentro do vetor <code>c(1, 2, 3, 4, 5)</code>, execute o comando <code>print(i^2)</code>. Qualquer outro comando dentro das chaves <code>{ ... }</code> seria executado para cada valor do vetor.</p>
<p>Para entendermos melhor, vamos repensar o exemplo das séries usando o <code>for()</code>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="manipulando-os-dados.html#cb106-1" aria-hidden="true" tabindex="-1"></a>lista.de.arquivos <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">&#39;dados/dados_loop&#39;</span>) <span class="co">#lista todos os arquivos de uma pasta</span></span>
<span id="cb106-2"><a href="manipulando-os-dados.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.vector</span>(lista.de.arquivos)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="manipulando-os-dados.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> lista.de.arquivos) {</span>
<span id="cb108-2"><a href="manipulando-os-dados.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;Leia o arquivo:&#39;</span>, i))</span>
<span id="cb108-3"><a href="manipulando-os-dados.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#exemplo: read_delim(i, delim = &quot;|&quot;)</span></span>
<span id="cb108-4"><a href="manipulando-os-dados.html#cb108-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Leia o arquivo: arquivo1.txt&quot;
## [1] &quot;Leia o arquivo: arquivo10.txt&quot;
## [1] &quot;Leia o arquivo: arquivo11.txt&quot;
## [1] &quot;Leia o arquivo: arquivo12.txt&quot;
## [1] &quot;Leia o arquivo: arquivo13.txt&quot;
## [1] &quot;Leia o arquivo: arquivo2.txt&quot;
## [1] &quot;Leia o arquivo: arquivo3.txt&quot;
## [1] &quot;Leia o arquivo: arquivo4.txt&quot;
## [1] &quot;Leia o arquivo: arquivo5.txt&quot;
## [1] &quot;Leia o arquivo: arquivo6.txt&quot;
## [1] &quot;Leia o arquivo: arquivo7.txt&quot;
## [1] &quot;Leia o arquivo: arquivo8.txt&quot;
## [1] &quot;Leia o arquivo: arquivo9.txt&quot;</code></pre>
<p>Também é possível utilizar loop com if. No exemplo a seguir, queremos ver todos os números de 1 a 1000 que são divisíveis por 29 e por 3 ao mesmo tempo. Para isso, utilizaremos o operador <code>%%</code>, que mostra o resto da divisão. Se o resto for zero, é divisível.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="manipulando-os-dados.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb110-2"><a href="manipulando-os-dados.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>((i <span class="sc">%%</span> <span class="dv">29</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (i <span class="sc">%%</span> <span class="dv">3</span> <span class="sc">==</span> <span class="dv">0</span>)){</span>
<span id="cb110-3"><a href="manipulando-os-dados.html#cb110-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(i)</span>
<span id="cb110-4"><a href="manipulando-os-dados.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-5"><a href="manipulando-os-dados.html#cb110-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 87
## [1] 174
## [1] 261
## [1] 348
## [1] 435
## [1] 522
## [1] 609
## [1] 696
## [1] 783
## [1] 870
## [1] 957</code></pre>
</div>
<div id="while" class="section level4" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> While</h4>
<p>O <code>while()</code> também é uma estrutura de controle de fluxo do tipo loop, mas, diferentemente do <code>for()</code>, o while executa as tarefas repetidamente até que uma condição seja satisfeita, não percorrendo um vetor.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="manipulando-os-dados.html#cb112-1" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb112-2"><a href="manipulando-os-dados.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(i <span class="sc">&lt;=</span> <span class="dv">5</span>){</span>
<span id="cb112-3"><a href="manipulando-os-dados.html#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb112-4"><a href="manipulando-os-dados.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb112-5"><a href="manipulando-os-dados.html#cb112-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5</code></pre>
<p>O uso do while é um pouco menos intuitivo, mas não menos importante. O while é mais apropriado para eventos de automação ou simulação, onde tarefas serão executadas quando um “gatilho” for acionado. Um simples exemplo para ajudar na intuição de seu uso é:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="manipulando-os-dados.html#cb114-1" aria-hidden="true" tabindex="-1"></a>automatico <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">&#39;dados/automatico/&#39;</span>)</span>
<span id="cb114-2"><a href="manipulando-os-dados.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(automatico) <span class="sc">==</span> <span class="dv">0</span></span></code></pre></div>
<p>Temos uma pasta vazia. O loop abaixo vai monitorar essa pasta. Enquanto essa pasta estiver vazia, ele estará em execução. Quando você colocar um arquivo dentro dessa pasta, vai mudar a condição <code>length(automatico) == 0</code> de <code>TRUE</code> para <code>FALSE</code> e vai mudar a condição <code>length(automatico) &gt; 0</code> de <code>FALSE</code> para <code>TRUE</code>, disparando todas as tarefas programadas. Usamos a função <code>Sys.sleep(5)</code> para que o código espere por mais cinco segundos antes de começar o loop novamente.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="manipulando-os-dados.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">length</span>(automatico) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb115-2"><a href="manipulando-os-dados.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  automatico <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">&#39;dados/automatico/&#39;</span>)</span>
<span id="cb115-3"><a href="manipulando-os-dados.html#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(automatico) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb115-4"><a href="manipulando-os-dados.html#cb115-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&#39;O arquivo chegou!&#39;</span>)</span>
<span id="cb115-5"><a href="manipulando-os-dados.html#cb115-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&#39;Inicia a leitura dos dados&#39;</span>)</span>
<span id="cb115-6"><a href="manipulando-os-dados.html#cb115-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&#39;Faz a manipulação&#39;</span>)</span>
<span id="cb115-7"><a href="manipulando-os-dados.html#cb115-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&#39;Envia email informando conclusão dos cálculos&#39;</span>)</span>
<span id="cb115-8"><a href="manipulando-os-dados.html#cb115-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb115-9"><a href="manipulando-os-dados.html#cb115-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&#39;aguardando arquivo...&#39;</span>)</span>
<span id="cb115-10"><a href="manipulando-os-dados.html#cb115-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">5</span>)</span>
<span id="cb115-11"><a href="manipulando-os-dados.html#cb115-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-12"><a href="manipulando-os-dados.html#cb115-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Faça o teste: execute o código acima, aguarde alguns segundos e perceba que nada aconteceu. Crie um arquivo qualquer dentro da pasta <code>dados/automatico/</code>. Imediatamente o loop será encerrado e as tarefas executadas. Observe o output em tela.</p>
</div>
</div>
<div id="funções-1" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Funções</h3>
<p>Funções “encapsulam” uma sequência de comandos e instruções. É uma estrutura nomeada, que recebe parâmetros para iniciar sua execução e retorna um resultado ao final. Até o momento, você já usou diversas funções. Vejamos então como criar uma função:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="manipulando-os-dados.html#cb116-1" aria-hidden="true" tabindex="-1"></a>sua_funcao <span class="ot">&lt;-</span> <span class="cf">function</span>(parametro1, parametro2){</span>
<span id="cb116-2"><a href="manipulando-os-dados.html#cb116-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb116-3"><a href="manipulando-os-dados.html#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sequência de tarefas</span></span>
<span id="cb116-4"><a href="manipulando-os-dados.html#cb116-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb116-5"><a href="manipulando-os-dados.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(valores_retornados)</span>
<span id="cb116-6"><a href="manipulando-os-dados.html#cb116-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-7"><a href="manipulando-os-dados.html#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="manipulando-os-dados.html#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co"># chamada da função</span></span>
<span id="cb116-9"><a href="manipulando-os-dados.html#cb116-9" aria-hidden="true" tabindex="-1"></a>sua_funcao</span></code></pre></div>
<p>Agora tente entender a seguinte função:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="manipulando-os-dados.html#cb117-1" aria-hidden="true" tabindex="-1"></a>montanha_russa <span class="ot">&lt;-</span> <span class="cf">function</span>(palavra) {</span>
<span id="cb117-2"><a href="manipulando-os-dados.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  retorno <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb117-3"><a href="manipulando-os-dados.html#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nchar</span>(palavra)) {</span>
<span id="cb117-4"><a href="manipulando-os-dados.html#cb117-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb117-5"><a href="manipulando-os-dados.html#cb117-5" aria-hidden="true" tabindex="-1"></a>      retorno <span class="ot">&lt;-</span> <span class="fu">paste0</span>(retorno, <span class="fu">tolower</span>(<span class="fu">substr</span>(palavra, i, i)))</span>
<span id="cb117-6"><a href="manipulando-os-dados.html#cb117-6" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb117-7"><a href="manipulando-os-dados.html#cb117-7" aria-hidden="true" tabindex="-1"></a>      retorno <span class="ot">&lt;-</span> <span class="fu">paste0</span>(retorno, <span class="fu">toupper</span>(<span class="fu">substr</span>(palavra, i, i)))</span>
<span id="cb117-8"><a href="manipulando-os-dados.html#cb117-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb117-9"><a href="manipulando-os-dados.html#cb117-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb117-10"><a href="manipulando-os-dados.html#cb117-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(retorno)</span>
<span id="cb117-11"><a href="manipulando-os-dados.html#cb117-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-12"><a href="manipulando-os-dados.html#cb117-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-13"><a href="manipulando-os-dados.html#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="fu">montanha_russa</span>(<span class="st">&#39;teste de função: letras maiúsculas e minúsculas&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;TeStE De fUnÇãO: lEtRaS MaIúScUlAs e mInÚsCuLaS&quot;</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="manipulando-os-dados.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">montanha_russa</span>(<span class="st">&#39;CONSEGUIU ENTENDER?&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;CoNsEgUiU EnTeNdEr?&quot;</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="manipulando-os-dados.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">montanha_russa</span>(<span class="st">&#39;É Fácil Usar Funções!&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;É FáCiL UsAr fUnÇõEs!&quot;</code></pre>
</div>
</div>
<div id="manipulações-com-r-base" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Manipulações com R base</h2>
<p>Dominar a manipulação de data frames e vetores é muito importante. Em geral, toda manipulação pode ser feita com o R base, mas acreditamos que utilizando técnicas do tidyverse a atividade fica bem mais fácil. Portanto, utilizaremos o <code>dplyr</code>, um dos principais pacotes do tidyverse. Porém, alguns conceitos do R base são clássicos e precisam ser dominados.</p>
<div id="trabalhando-com-colunas-de-um-data.frame" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Trabalhando com colunas de um data.frame</h3>
<p>Para selecionar ou trabalhar separadamente com apenas um campo (coluna) do seu data.frame, deve-se utilizar o <code>$</code>. Repare nas funções abaixo e no uso do sifrão.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="manipulando-os-dados.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airquality<span class="sc">$</span>Ozone)</span></code></pre></div>
<pre><code>## [1] 41 36 12 18 NA 28</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="manipulando-os-dados.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(airquality<span class="sc">$</span>Ozone)</span></code></pre></div>
<pre><code>## [1] 14 30 NA 14 18 20</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="manipulando-os-dados.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(airquality<span class="sc">$</span>Ozone) <span class="co"># Informa o tipo da coluna</span></span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="manipulando-os-dados.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.vector</span>(airquality<span class="sc">$</span>Ozone) <span class="co"># Apenas para verificar que cada coluna de um data.frame é um vector</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="manipulando-os-dados.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>sgPartido) <span class="co"># Função que retorna apenas os valores únicos, sem repetição, de um vetor</span></span></code></pre></div>
<pre><code>##  [1] NA              &quot;PSDB&quot;          &quot;DEM&quot;           &quot;PP&quot;            &quot;PDT&quot;           &quot;PODE&quot;          &quot;PSB&quot;          
##  [8] &quot;PT&quot;            &quot;REPUBLICANOS&quot;  &quot;CIDADANIA&quot;     &quot;PSOL&quot;          &quot;MDB&quot;           &quot;PSD&quot;           &quot;PCdoB&quot;        
## [15] &quot;PL&quot;            &quot;PTB&quot;           &quot;PROS&quot;          &quot;PSC&quot;           &quot;PSL&quot;           &quot;SOLIDARIEDADE&quot; &quot;NOVO&quot;         
## [22] &quot;AVANTE&quot;        &quot;PATRIOTA&quot;      &quot;PV&quot;            &quot;REDE&quot;</code></pre>
<p>Lembre-se sempre: cada coluna de um data.frame é um vetor, portanto todos os registros (linhas) daquela coluna devem ser do mesmo tipo. Um data.frame pode ser considerado um conjunto de vetores nomeados, todos do mesmo tamanho, ou seja, todos com a mesma quantidade de registros.</p>
<p>Usando termos mais técnicos, um data frame é um conjunto de dados HETEROGÊNEOS, pois cada coluna pode ser de um tipo, e BIDIMENSIONAL, por possuir apenas linhas e colunas. Já o vetor é um conjunto de dados HOMOGÊNEO, pois só pode ter valores de um mesmo tipo, e UNIDIMENSIONAL.</p>
<p>Com esses conceitos em mente fica mais fácil entender o que mostraremos a seguir:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="manipulando-os-dados.html#cb133-1" aria-hidden="true" tabindex="-1"></a>vetor <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">100</span>, <span class="at">by=</span><span class="dv">15</span>)) <span class="co">#vetor de 0 a 100, de 15 em 15.</span></span>
<span id="cb133-2"><a href="manipulando-os-dados.html#cb133-2" aria-hidden="true" tabindex="-1"></a>vetor <span class="co">#lista todos os elementos</span></span></code></pre></div>
<pre><code>## [1]  0 15 30 45 60 75 90</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="manipulando-os-dados.html#cb135-1" aria-hidden="true" tabindex="-1"></a>vetor[<span class="dv">1</span>] <span class="co">#mostra apenas o elemento na posição 1</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="manipulando-os-dados.html#cb137-1" aria-hidden="true" tabindex="-1"></a>vetor[<span class="dv">2</span>] <span class="co">#apenas o elemento na posição 2</span></span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="manipulando-os-dados.html#cb139-1" aria-hidden="true" tabindex="-1"></a>vetor[<span class="dv">7</span>] <span class="co">#apenas o elemento na posição 7</span></span></code></pre></div>
<pre><code>## [1] 90</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="manipulando-os-dados.html#cb141-1" aria-hidden="true" tabindex="-1"></a>vetor[<span class="dv">8</span>] <span class="co">#não existe nada na posição 8...</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>A notação <code>[]</code> é usada para selecionar o elemento em uma ou mais posições do vetor.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="manipulando-os-dados.html#cb143-1" aria-hidden="true" tabindex="-1"></a>vetor[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">7</span>)] <span class="co">#selecionando mais de um elemento no vetor</span></span></code></pre></div>
<pre><code>## [1] 15 90</code></pre>
<p>Uma notação parecida é usada para selecionar elementos no <code>data.frame</code>. Porém, como já comentamos, data frames são BIDIMENSIONAIS. Então usaremos a notação <code>[,]</code> com uma vírgula separando qual a linha (posição antes da vírgula) e a coluna (posição após a vírgula) que queremos selecionar.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="manipulando-os-dados.html#cb145-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">10</span>, ] <span class="co">#linha 10, todas as colunas</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 31
##   txNomeParlamentar         cpf ideCadastro nuCarteiraParlamentar nuLegislatura sgUF  sgPartido codLegislatura numSubCota txtDescricao
##   &lt;chr&gt;                   &lt;dbl&gt;       &lt;dbl&gt;                 &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;       
## 1 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         12 ASSINATURA …
## # … with 21 more variables: numEspecificacaoSubCota &lt;dbl&gt;, txtDescricaoEspecificacao &lt;chr&gt;, txtFornecedor &lt;chr&gt;,
## #   txtCNPJCPF &lt;chr&gt;, txtNumero &lt;chr&gt;, indTipoDocumento &lt;dbl&gt;, datEmissao &lt;dttm&gt;, vlrDocumento &lt;chr&gt;, vlrGlosa &lt;chr&gt;,
## #   vlrLiquido &lt;chr&gt;, numMes &lt;dbl&gt;, numAno &lt;dbl&gt;, numParcela &lt;dbl&gt;, txtPassageiro &lt;chr&gt;, txtTrecho &lt;chr&gt;, numLote &lt;dbl&gt;,
## #   numRessarcimento &lt;dbl&gt;, vlrRestituicao &lt;lgl&gt;, nuDeputadoId &lt;dbl&gt;, ideDocumento &lt;dbl&gt;, urlDocumento &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="manipulando-os-dados.html#cb147-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">72</span>, <span class="dv">3</span>] <span class="co">#linha 72, coluna 3</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   ideCadastro
##         &lt;dbl&gt;
## 1          NA</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="manipulando-os-dados.html#cb149-1" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>), <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)] <span class="co"># selecionando mais de uma linha e coluna em um data.frame</span></span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##     cpf ideCadastro nuCarteiraParlamentar
##   &lt;dbl&gt;       &lt;dbl&gt;                 &lt;dbl&gt;
## 1    NA          NA                    NA
## 2    NA          NA                    NA</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="manipulando-os-dados.html#cb151-1" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>), ]</span></code></pre></div>
<pre><code>## # A tibble: 11 × 31
##    txNomeParlamentar         cpf ideCadastro nuCarteiraParlamentar nuLegislatura sgUF  sgPartido codLegislatura numSubCota txtDescricao
##    &lt;chr&gt;                   &lt;dbl&gt;       &lt;dbl&gt;                 &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;       
##  1 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         12 ASSINATURA …
##  2 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         12 ASSINATURA …
##  3 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         13 FORNECIMENT…
##  4 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         13 FORNECIMENT…
##  5 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         13 FORNECIMENT…
##  6 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         13 FORNECIMENT…
##  7 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         13 FORNECIMENT…
##  8 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         13 FORNECIMENT…
##  9 LIDERANÇA DO NOVO          NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          1 MANUTENÇÃO …
## 10 LIDERANÇA DO NOVO          NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          1 MANUTENÇÃO …
## 11 LIDERANÇA DO NOVO          NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          1 MANUTENÇÃO …
## # … with 21 more variables: numEspecificacaoSubCota &lt;dbl&gt;, txtDescricaoEspecificacao &lt;chr&gt;, txtFornecedor &lt;chr&gt;,
## #   txtCNPJCPF &lt;chr&gt;, txtNumero &lt;chr&gt;, indTipoDocumento &lt;dbl&gt;, datEmissao &lt;dttm&gt;, vlrDocumento &lt;chr&gt;, vlrGlosa &lt;chr&gt;,
## #   vlrLiquido &lt;chr&gt;, numMes &lt;dbl&gt;, numAno &lt;dbl&gt;, numParcela &lt;dbl&gt;, txtPassageiro &lt;chr&gt;, txtTrecho &lt;chr&gt;, numLote &lt;dbl&gt;,
## #   numRessarcimento &lt;dbl&gt;, vlrRestituicao &lt;lgl&gt;, nuDeputadoId &lt;dbl&gt;, ideDocumento &lt;dbl&gt;, urlDocumento &lt;chr&gt;</code></pre>
<p>Repare na notação c(10:20), você pode usar <code>:</code> para criar sequências. Experimente <code>1:1000</code></p>
<p>Também é possível selecionar o item desejado utilizando o próprio nome da coluna:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="manipulando-os-dados.html#cb153-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">c</span>(<span class="st">&#39;sgPartido&#39;</span>, <span class="st">&#39;cpf&#39;</span>)]</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    sgPartido   cpf
##    &lt;chr&gt;     &lt;dbl&gt;
##  1 &lt;NA&gt;         NA
##  2 &lt;NA&gt;         NA
##  3 &lt;NA&gt;         NA
##  4 &lt;NA&gt;         NA
##  5 &lt;NA&gt;         NA
##  6 &lt;NA&gt;         NA
##  7 &lt;NA&gt;         NA
##  8 &lt;NA&gt;         NA
##  9 &lt;NA&gt;         NA
## 10 &lt;NA&gt;         NA</code></pre>
<p>Existem diversas outras formas de seleção e manipulação de dados, como, por exemplo, seleção condicional:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="manipulando-os-dados.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df[df<span class="sc">$</span>sgPartido <span class="sc">==</span> <span class="st">&#39;PT&#39;</span>, ])</span></code></pre></div>
<pre><code>## # A tibble: 6 × 31
##   txNomeParlamentar   cpf ideCadastro nuCarteiraParlamentar nuLegislatura sgUF  sgPartido codLegislatura numSubCota txtDescricao
##   &lt;chr&gt;             &lt;dbl&gt;       &lt;dbl&gt;                 &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;       
## 1 &lt;NA&gt;                 NA          NA                    NA            NA &lt;NA&gt;  &lt;NA&gt;                  NA         NA &lt;NA&gt;        
## 2 &lt;NA&gt;                 NA          NA                    NA            NA &lt;NA&gt;  &lt;NA&gt;                  NA         NA &lt;NA&gt;        
## 3 &lt;NA&gt;                 NA          NA                    NA            NA &lt;NA&gt;  &lt;NA&gt;                  NA         NA &lt;NA&gt;        
## 4 &lt;NA&gt;                 NA          NA                    NA            NA &lt;NA&gt;  &lt;NA&gt;                  NA         NA &lt;NA&gt;        
## 5 &lt;NA&gt;                 NA          NA                    NA            NA &lt;NA&gt;  &lt;NA&gt;                  NA         NA &lt;NA&gt;        
## 6 &lt;NA&gt;                 NA          NA                    NA            NA &lt;NA&gt;  &lt;NA&gt;                  NA         NA &lt;NA&gt;        
## # … with 21 more variables: numEspecificacaoSubCota &lt;dbl&gt;, txtDescricaoEspecificacao &lt;chr&gt;, txtFornecedor &lt;chr&gt;,
## #   txtCNPJCPF &lt;chr&gt;, txtNumero &lt;chr&gt;, indTipoDocumento &lt;dbl&gt;, datEmissao &lt;dttm&gt;, vlrDocumento &lt;chr&gt;, vlrGlosa &lt;chr&gt;,
## #   vlrLiquido &lt;chr&gt;, numMes &lt;dbl&gt;, numAno &lt;dbl&gt;, numParcela &lt;dbl&gt;, txtPassageiro &lt;chr&gt;, txtTrecho &lt;chr&gt;, numLote &lt;dbl&gt;,
## #   numRessarcimento &lt;dbl&gt;, vlrRestituicao &lt;lgl&gt;, nuDeputadoId &lt;dbl&gt;, ideDocumento &lt;dbl&gt;, urlDocumento &lt;chr&gt;</code></pre>
<p>Em todas as comparações do R usamos operadores lógicos. São operações matemáticas em que o resultado é <code>TRUE</code> ou <code>FALSE</code> (tipo <code>logic</code>). Para melhor entendimento, selecionamos alguns operadores lógicos e seus significados:</p>
<ul>
<li><code>==</code> igual a: compara dois objetos e se forem iguais retorna TRUE, caso contrário, FALSE;</li>
<li><code>!=</code> diferente: compara dois objetos e se forem diferentes retorna TRUE, caso contrário, FALSE;</li>
<li><code>|</code> ou (or): compara dois objetos, se um dos dois for TRUE, retorna TRUE, se os dois forem FALSE, retorna FALSE;</li>
<li><code>&amp;</code> e (and): compara dois objetos, se os dois forem TRUE, retorna TRUE, se um dos dois ou os dois forem FALSE, retorna FALSE;</li>
<li><code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code> maior, maior ou igual, menor, menor ou igual: compara grandeza de dois números e retorna TRUE ou FALSE conforme a condição;</li>
</ul>
<p>É possível fazer muita coisa com o R base, porém, vamos avançar com as manipulações, utilizando o pacote <code>dplyr</code>, por ser mais simples e, por isso, de mais rápido aprendizado.</p>
</div>
</div>
<div id="pacote-dplyr" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Pacote dplyr</h2>
<p>O forte do pacote <code>dplyr</code> é a sintaxe simples e concisa, o que facilita o aprendizado e torna o pacote um dos preferidos para as tarefas do dia a dia. Também conta como ponto forte sua otimização de performance para manipulação de dados. Ao carregar o pacote <code>tidyverse</code>, você já carregará automaticamente o pacote <code>dplyr</code>, mas você também pode carregá-lo individualmente:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="manipulando-os-dados.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb157-2"><a href="manipulando-os-dados.html#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div class="rmdtip">
<p><strong>Referências:</strong><br />
<a href="https://dplyr.tidyverse.org">Site do pacote <code>dplyr</code></a></p>
</div>
<div id="verbetes-do-dplyr-e-o-operador" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Verbetes do dplyr e o operador <code>%&gt;%</code></h3>
<p>O <code>dplyr</code> cobre praticamente todas as tarefas básicas da manipulação de dados: agregar, sumarizar, filtrar, ordenar, criar variáveis, joins, dentre outras.</p>
<p>As funções do <code>dplyr</code> reproduzem as principais tarefas da manipulação, de forma bastante intuitiva. Veja só:</p>
<ul>
<li><code>select()</code><br />
</li>
<li><code>filter()</code><br />
</li>
<li><code>arrange()</code><br />
</li>
<li><code>mutate()</code><br />
</li>
<li><code>group_by()</code><br />
</li>
<li><code>summarise()</code></li>
</ul>
<p>Esses são os principais verbetes, mas existem outros disponíveis, como por exemplo <code>slice()</code>, <code>rename()</code> e <code>transmute()</code>.
Além de nomes de funções intuitivos, o <code>dplyr</code> também faz uso de um recurso disponível em boa parte dos pacotes do Hadley, o operador <code>%&gt;%</code> (originário do pacote <code>magrittr</code>). Este operador encadeia as chamadas de funções de forma que você não vai precisar ficar chamando uma função dentro da outra ou ficar fazendo atribuições usando diversas linhas para concluir suas manipulações. Aliás, podemos dizer que esse operador <code>%&gt;%</code>, literalmente, cria um fluxo sequencial bastante claro e legível para todas as atividades de manipulação.</p>
<p>Os 6 principais verbetes listados acima possuem funções derivadas com os sufixos <code>_at</code>, <code>_if</code> e <code>_all</code>, que podem ser muito úteis em arquivos com muitas colunas.</p>
</div>
<div id="select" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Select</h3>
<p>O <code>select()</code> é a função mais simples de ser entendida. É usada para selecionar variáveis (colunas, campos, features…) do seu data frame.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="manipulando-os-dados.html#cb158-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">select</span>(urlDocumento, txtDescricao, vlrRestituicao)</span></code></pre></div>
<pre><code>## # A tibble: 144,367 × 3
##    urlDocumento                                                                            txtDescricao             vlrRestituicao
##    &lt;chr&gt;                                                                                   &lt;chr&gt;                    &lt;lgl&gt;         
##  1 http://camara.leg.br/cota-parlamentar/nota-fiscal-eletronica?ideDocumentoFiscal=7050172 CONSULTORIAS, PESQUISAS… NA            
##  2 http://camara.leg.br/cota-parlamentar/nota-fiscal-eletronica?ideDocumentoFiscal=7058437 CONSULTORIAS, PESQUISAS… NA            
##  3 http://camara.leg.br/cota-parlamentar/nota-fiscal-eletronica?ideDocumentoFiscal=7078508 CONSULTORIAS, PESQUISAS… NA            
##  4 http://camara.leg.br/cota-parlamentar/nota-fiscal-eletronica?ideDocumentoFiscal=7123566 CONSULTORIAS, PESQUISAS… NA            
##  5 http://camara.leg.br/cota-parlamentar/nota-fiscal-eletronica?ideDocumentoFiscal=7067718 DIVULGAÇÃO DA ATIVIDADE… NA            
##  6 http://camara.leg.br/cota-parlamentar/nota-fiscal-eletronica?ideDocumentoFiscal=7088718 DIVULGAÇÃO DA ATIVIDADE… NA            
##  7 http://camara.leg.br/cota-parlamentar/nota-fiscal-eletronica?ideDocumentoFiscal=7101137 DIVULGAÇÃO DA ATIVIDADE… NA            
##  8 http://camara.leg.br/cota-parlamentar/nota-fiscal-eletronica?ideDocumentoFiscal=7140186 DIVULGAÇÃO DA ATIVIDADE… NA            
##  9 &lt;NA&gt;                                                                                    ASSINATURA DE PUBLICAÇÕ… NA            
## 10 http://camara.leg.br/cota-parlamentar/nota-fiscal-eletronica?ideDocumentoFiscal=7042111 ASSINATURA DE PUBLICAÇÕ… NA            
## # … with 144,357 more rows</code></pre>
<p>Você pode, também, fazer uma “seleção negativa,” ou seja, escolher as colunas que não quer:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="manipulando-os-dados.html#cb160-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>txNomeParlamentar)</span></code></pre></div>
<pre><code>## # A tibble: 144,367 × 30
##      cpf ideCadastro nuCarteiraParlamentar nuLegislatura sgUF  sgPartido codLegislatura numSubCota txtDescricao   numEspecificaca…
##    &lt;dbl&gt;       &lt;dbl&gt;                 &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt;
##  1    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIAS,…                0
##  2    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIAS,…                0
##  3    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIAS,…                0
##  4    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIAS,…                0
##  5    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO DA…                0
##  6    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO DA…                0
##  7    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO DA…                0
##  8    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO DA…                0
##  9    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         12 ASSINATURA DE…                0
## 10    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         12 ASSINATURA DE…                0
## # … with 144,357 more rows, and 20 more variables: txtDescricaoEspecificacao &lt;chr&gt;, txtFornecedor &lt;chr&gt;, txtCNPJCPF &lt;chr&gt;,
## #   txtNumero &lt;chr&gt;, indTipoDocumento &lt;dbl&gt;, datEmissao &lt;dttm&gt;, vlrDocumento &lt;chr&gt;, vlrGlosa &lt;chr&gt;, vlrLiquido &lt;chr&gt;,
## #   numMes &lt;dbl&gt;, numAno &lt;dbl&gt;, numParcela &lt;dbl&gt;, txtPassageiro &lt;chr&gt;, txtTrecho &lt;chr&gt;, numLote &lt;dbl&gt;, numRessarcimento &lt;dbl&gt;,
## #   vlrRestituicao &lt;lgl&gt;, nuDeputadoId &lt;dbl&gt;, ideDocumento &lt;dbl&gt;, urlDocumento &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="manipulando-os-dados.html#cb162-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(txNomeParlamentar, cpf))</span></code></pre></div>
<pre><code>## # A tibble: 144,367 × 29
##    ideCadastro nuCarteiraParlamentar nuLegislatura sgUF  sgPartido codLegislatura numSubCota txtDescricao        numEspecificacao…
##          &lt;dbl&gt;                 &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;                           &lt;dbl&gt;
##  1          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIAS, PESQ…                 0
##  2          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIAS, PESQ…                 0
##  3          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIAS, PESQ…                 0
##  4          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIAS, PESQ…                 0
##  5          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO DA ATIV…                 0
##  6          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO DA ATIV…                 0
##  7          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO DA ATIV…                 0
##  8          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO DA ATIV…                 0
##  9          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         12 ASSINATURA DE PUBL…                 0
## 10          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         12 ASSINATURA DE PUBL…                 0
## # … with 144,357 more rows, and 20 more variables: txtDescricaoEspecificacao &lt;chr&gt;, txtFornecedor &lt;chr&gt;, txtCNPJCPF &lt;chr&gt;,
## #   txtNumero &lt;chr&gt;, indTipoDocumento &lt;dbl&gt;, datEmissao &lt;dttm&gt;, vlrDocumento &lt;chr&gt;, vlrGlosa &lt;chr&gt;, vlrLiquido &lt;chr&gt;,
## #   numMes &lt;dbl&gt;, numAno &lt;dbl&gt;, numParcela &lt;dbl&gt;, txtPassageiro &lt;chr&gt;, txtTrecho &lt;chr&gt;, numLote &lt;dbl&gt;, numRessarcimento &lt;dbl&gt;,
## #   vlrRestituicao &lt;lgl&gt;, nuDeputadoId &lt;dbl&gt;, ideDocumento &lt;dbl&gt;, urlDocumento &lt;chr&gt;</code></pre>
<ul>
<li><code>select_at()</code>: Selecionar um conjunto de variáveis, especificadas pelo nome ou pela posição numérica, podendo aplicar uma função ao nome delas:</li>
</ul>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="manipulando-os-dados.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># manter apenas as colunas que começam com S e transformar o nome para maiusculo</span></span>
<span id="cb164-2"><a href="manipulando-os-dados.html#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co">#df %&gt;% select_at(vars(starts_with(&quot;vlr&quot;)))</span></span>
<span id="cb164-3"><a href="manipulando-os-dados.html#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="co"># é equivalente a:</span></span>
<span id="cb164-4"><a href="manipulando-os-dados.html#cb164-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;vlr&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 144,367 × 4
##    vlrDocumento vlrGlosa vlrLiquido vlrRestituicao
##    &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;      &lt;lgl&gt;         
##  1 1527.28      0        1527.28    NA            
##  2 1527.28      0        1527.28    NA            
##  3 1527.28      0        1527.28    NA            
##  4 1527.28      0        1527.28    NA            
##  5 1527.28      0        1527.28    NA            
##  6 1527.28      0        1527.28    NA            
##  7 1527.28      0        1527.28    NA            
##  8 1527.28      0        1527.28    NA            
##  9 613.61       0        613.61     NA            
## 10 1527.28      0        1527.28    NA            
## # … with 144,357 more rows</code></pre>
<ul>
<li><code>select_if()</code>: Selecionar o conjunto de variáveis do dataframe que atende a um teste lógico:</li>
</ul>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="manipulando-os-dados.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selecionar apenas as colunas numericas do dataframe</span></span>
<span id="cb166-2"><a href="manipulando-os-dados.html#cb166-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 15
##     cpf ideCadastro nuCarteiraParlamen… nuLegislatura codLegislatura numSubCota numEspecificacaoSu… indTipoDocumento numMes numAno
##   &lt;dbl&gt;       &lt;dbl&gt;               &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;               &lt;dbl&gt;            &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1    NA          NA                  NA          2019             56          4                   0                4      4   2020
## 2    NA          NA                  NA          2019             56          4                   0                4      5   2020
## 3    NA          NA                  NA          2019             56          4                   0                4      7   2020
## 4    NA          NA                  NA          2019             56          4                   0                4     11   2020
## 5    NA          NA                  NA          2019             56          5                   0                4      6   2020
## 6    NA          NA                  NA          2019             56          5                   0                4      8   2020
## # … with 5 more variables: numParcela &lt;dbl&gt;, numLote &lt;dbl&gt;, numRessarcimento &lt;dbl&gt;, nuDeputadoId &lt;dbl&gt;, ideDocumento &lt;dbl&gt;</code></pre>
<ul>
<li><code>select_all()</code>: seleciona todas as colunas, opcionalmente aplicando uma função ao nome delas.</li>
</ul>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="manipulando-os-dados.html#cb168-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">select_all</span>(tolower)</span></code></pre></div>
<pre><code>## # A tibble: 144,367 × 31
##    txnomeparlamentar         cpf idecadastro nucarteiraparlamentar nulegislatura sguf  sgpartido codlegislatura numsubcota txtdescricao
##    &lt;chr&gt;                   &lt;dbl&gt;       &lt;dbl&gt;                 &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;       
##  1 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIA…
##  2 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIA…
##  3 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIA…
##  4 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 CONSULTORIA…
##  5 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO …
##  6 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO …
##  7 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO …
##  8 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO …
##  9 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         12 ASSINATURA …
## 10 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         12 ASSINATURA …
## # … with 144,357 more rows, and 21 more variables: numespecificacaosubcota &lt;dbl&gt;, txtdescricaoespecificacao &lt;chr&gt;,
## #   txtfornecedor &lt;chr&gt;, txtcnpjcpf &lt;chr&gt;, txtnumero &lt;chr&gt;, indtipodocumento &lt;dbl&gt;, datemissao &lt;dttm&gt;, vlrdocumento &lt;chr&gt;,
## #   vlrglosa &lt;chr&gt;, vlrliquido &lt;chr&gt;, nummes &lt;dbl&gt;, numano &lt;dbl&gt;, numparcela &lt;dbl&gt;, txtpassageiro &lt;chr&gt;, txttrecho &lt;chr&gt;,
## #   numlote &lt;dbl&gt;, numressarcimento &lt;dbl&gt;, vlrrestituicao &lt;lgl&gt;, nudeputadoid &lt;dbl&gt;, idedocumento &lt;dbl&gt;, urldocumento &lt;chr&gt;</code></pre>
<div class="rmdtip">
<p><strong>Referências:</strong><br />
<a href="https://dplyr.tidyverse.org/reference/select.html">Documentação da função <code>select()</code></a><br />
<a href="https://dplyr.tidyverse.org/reference/select_all.html">Documentação das funções derivadas de <code>select()</code></a></p>
</div>
</div>
<div id="mutate" class="section level3" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Mutate</h3>
<p>Para criar novos campos ou transformar campos já existentes, podemos usar a <code>mutate()</code>. Ela é útil para, por exemplo, converter classes de colunas:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="manipulando-os-dados.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># criar coluna com o nome do senador em minusculo</span></span>
<span id="cb170-2"><a href="manipulando-os-dados.html#cb170-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb170-3"><a href="manipulando-os-dados.html#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vlrDocumento =</span> <span class="fu">as.numeric</span>(vlrDocumento),</span>
<span id="cb170-4"><a href="manipulando-os-dados.html#cb170-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">vlrLiquido =</span> <span class="fu">as.numeric</span>(vlrLiquido),</span>
<span id="cb170-5"><a href="manipulando-os-dados.html#cb170-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">vlrRestituicao =</span> <span class="fu">as.numeric</span>(vlrRestituicao))</span></code></pre></div>
<p>Caso o argumento da esquerda em <code>mutate()</code> seja um nome de coluna que já existe no dataframe, esta será sobrescrita:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="manipulando-os-dados.html#cb171-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb171-2"><a href="manipulando-os-dados.html#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(txNomeParlamentar, vlrLiquido) <span class="sc">%&gt;%</span> </span>
<span id="cb171-3"><a href="manipulando-os-dados.html#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">txNomeParlamentar =</span> <span class="fu">tolower</span>(txNomeParlamentar)) <span class="sc">%&gt;%</span> </span>
<span id="cb171-4"><a href="manipulando-os-dados.html#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   txNomeParlamentar       vlrLiquido
##   &lt;chr&gt;                        &lt;dbl&gt;
## 1 liderança do democratas      1527.
## 2 liderança do democratas      1527.
## 3 liderança do democratas      1527.
## 4 liderança do democratas      1527.
## 5 liderança do democratas      1527.
## 6 liderança do democratas      1527.</code></pre>
<p>Veja como é simples realizar a operação acima, de transformar uma coluna para minúsculo, para todas as colunas de texto do dataframe com o auxílio de <code>mutate_if()</code>, na qual o primeiro argumento é um teste lógico e o segundo é a função a ser aplicada para todas as colunas onde o teste lógico seja <code>TRUE</code>.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="manipulando-os-dados.html#cb173-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb173-2"><a href="manipulando-os-dados.html#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># o primeiro argumento de mutate_if </span></span>
<span id="cb173-3"><a href="manipulando-os-dados.html#cb173-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, tolower) <span class="sc">%&gt;%</span> </span>
<span id="cb173-4"><a href="manipulando-os-dados.html#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 31
##   txNomeParlamentar         cpf ideCadastro nuCarteiraParlamentar nuLegislatura sgUF  sgPartido codLegislatura numSubCota txtDescricao
##   &lt;chr&gt;                   &lt;dbl&gt;       &lt;dbl&gt;                 &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;       
## 1 liderança do democratas    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 consultoria…
## 2 liderança do democratas    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 consultoria…
## 3 liderança do democratas    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 consultoria…
## 4 liderança do democratas    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          4 consultoria…
## 5 liderança do democratas    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 divulgação …
## 6 liderança do democratas    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 divulgação …
## # … with 21 more variables: numEspecificacaoSubCota &lt;dbl&gt;, txtDescricaoEspecificacao &lt;chr&gt;, txtFornecedor &lt;chr&gt;,
## #   txtCNPJCPF &lt;chr&gt;, txtNumero &lt;chr&gt;, indTipoDocumento &lt;dbl&gt;, datEmissao &lt;dttm&gt;, vlrDocumento &lt;dbl&gt;, vlrGlosa &lt;chr&gt;,
## #   vlrLiquido &lt;dbl&gt;, numMes &lt;dbl&gt;, numAno &lt;dbl&gt;, numParcela &lt;dbl&gt;, txtPassageiro &lt;chr&gt;, txtTrecho &lt;chr&gt;, numLote &lt;dbl&gt;,
## #   numRessarcimento &lt;dbl&gt;, vlrRestituicao &lt;dbl&gt;, nuDeputadoId &lt;dbl&gt;, ideDocumento &lt;dbl&gt;, urlDocumento &lt;chr&gt;</code></pre>
<div class="rmdtip">
<p><strong>Referências:</strong>
<a href="https://dplyr.tidyverse.org/reference/mutate.html">Documentação da função <code>mutate()</code></a><br />
<a href="https://dplyr.tidyverse.org/reference/mutate_all.html">Documentação das funções derivadas de <code>mutate()</code></a></p>
</div>
</div>
<div id="filter" class="section level3" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> Filter</h3>
<p>Além de escolher apenas alguns campos, você pode escolher apenas algumas linhas, utilizando alguma condição como filtragem. Para isso, basta utilizar a função <code>filter</code>.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="manipulando-os-dados.html#cb175-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb175-2"><a href="manipulando-os-dados.html#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cpf, txNomeParlamentar, txtDescricao, vlrDocumento) <span class="sc">%&gt;%</span> </span>
<span id="cb175-3"><a href="manipulando-os-dados.html#cb175-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vlrDocumento <span class="sc">&gt;=</span> <span class="dv">100000</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##           cpf txNomeParlamentar                 txtDescricao                         vlrDocumento
##         &lt;dbl&gt; &lt;chr&gt;                             &lt;chr&gt;                                       &lt;dbl&gt;
## 1  9006826200 Edmilson Rodrigues                DIVULGAÇÃO DA ATIVIDADE PARLAMENTAR.       151260
## 2 43196926168 Professora Dorinha Seabra Rezende DIVULGAÇÃO DA ATIVIDADE PARLAMENTAR.       105600
## 3 60433086653 Emidinho Madeira                  DIVULGAÇÃO DA ATIVIDADE PARLAMENTAR.       104520
## 4 41864883634 Subtenente Gonzaga                SERVIÇOS POSTAIS                           100587
## 5 49156470991 Christiane de Souza Yared         DIVULGAÇÃO DA ATIVIDADE PARLAMENTAR.       100000
## 6 47102500653 Rogério Correia                   DIVULGAÇÃO DA ATIVIDADE PARLAMENTAR.       144640</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="manipulando-os-dados.html#cb177-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(numMes <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 31
##   txNomeParlamentar         cpf ideCadastro nuCarteiraParlamentar nuLegislatura sgUF  sgPartido codLegislatura numSubCota txtDescricao
##   &lt;chr&gt;                   &lt;dbl&gt;       &lt;dbl&gt;                 &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;       
## 1 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          5 DIVULGAÇÃO …
## 2 LIDERANÇA DO DEMOCRATAS    NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56         13 FORNECIMENT…
## 3 LIDERANÇA DO NOVO          NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          1 MANUTENÇÃO …
## 4 LIDERANÇA DO NOVO          NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          1 MANUTENÇÃO …
## 5 LIDERANÇA DO NOVO          NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          1 MANUTENÇÃO …
## 6 LIDERANÇA DO NOVO          NA          NA                    NA          2019 &lt;NA&gt;  &lt;NA&gt;                  56          1 MANUTENÇÃO …
## # … with 21 more variables: numEspecificacaoSubCota &lt;dbl&gt;, txtDescricaoEspecificacao &lt;chr&gt;, txtFornecedor &lt;chr&gt;,
## #   txtCNPJCPF &lt;chr&gt;, txtNumero &lt;chr&gt;, indTipoDocumento &lt;dbl&gt;, datEmissao &lt;dttm&gt;, vlrDocumento &lt;dbl&gt;, vlrGlosa &lt;chr&gt;,
## #   vlrLiquido &lt;dbl&gt;, numMes &lt;dbl&gt;, numAno &lt;dbl&gt;, numParcela &lt;dbl&gt;, txtPassageiro &lt;chr&gt;, txtTrecho &lt;chr&gt;, numLote &lt;dbl&gt;,
## #   numRessarcimento &lt;dbl&gt;, vlrRestituicao &lt;dbl&gt;, nuDeputadoId &lt;dbl&gt;, ideDocumento &lt;dbl&gt;, urlDocumento &lt;chr&gt;</code></pre>
<div class="rmdtip">
<p><strong>Referências:</strong><br />
<a href="https://dplyr.tidyverse.org/reference/filter.html">Documentação da função <code>filter()</code></a><br />
<a href="https://dplyr.tidyverse.org/reference/filter_all.html">Documentação das funções derivadas de <code>filter()</code></a></p>
</div>
</div>
<div id="group-by-e-summarise" class="section level3" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> Group By e Summarise</h3>
<p>O <code>group_by()</code> e o <code>summarise()</code> são operações que trabalham na agregação dos dados, ou seja, um dado mais detalhado passa a ser um dado mais agregado e agrupado, em consequência disso, menos detalhado. O agrupamento de dados geralmente é trabalhado em conjunção com sumarizações, que usam funções matemáticas do tipo soma, média, desvio padrão etc.</p>
<p>Enquanto o <code>group_by()</code> “separa” seus dados nos grupos que você selecionar, o <code>summarise()</code> faz operações de agregação de linhas limitadas a esse grupo.</p>
<p>Vale observar que operações de agrupamento e sumarização geralmente DIMINUEM a quantidade de linhas dos seus dados, pois está reduzindo o nível de detalhe. Ou seja, de alguma forma, você está “perdendo” detalhe para “ganhar” agregação.</p>
<p>Como exemplo, utilizaremos os dados disponíveis no pacote nycflights13:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="manipulando-os-dados.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;nycflights13&quot;</span>)</span>
<span id="cb179-2"><a href="manipulando-os-dados.html#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb179-3"><a href="manipulando-os-dados.html#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;flights&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="manipulando-os-dados.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(flights)</span></code></pre></div>
<pre><code>## tibble [336,776 × 19] (S3: tbl_df/tbl/data.frame)
##  $ year          : int [1:336776] 2013 2013 2013 2013 2013 2013 2013 2013 2013 2013 ...
##  $ month         : int [1:336776] 1 1 1 1 1 1 1 1 1 1 ...
##  $ day           : int [1:336776] 1 1 1 1 1 1 1 1 1 1 ...
##  $ dep_time      : int [1:336776] 517 533 542 544 554 554 555 557 557 558 ...
##  $ sched_dep_time: int [1:336776] 515 529 540 545 600 558 600 600 600 600 ...
##  $ dep_delay     : num [1:336776] 2 4 2 -1 -6 -4 -5 -3 -3 -2 ...
##  $ arr_time      : int [1:336776] 830 850 923 1004 812 740 913 709 838 753 ...
##  $ sched_arr_time: int [1:336776] 819 830 850 1022 837 728 854 723 846 745 ...
##  $ arr_delay     : num [1:336776] 11 20 33 -18 -25 12 19 -14 -8 8 ...
##  $ carrier       : chr [1:336776] &quot;UA&quot; &quot;UA&quot; &quot;AA&quot; &quot;B6&quot; ...
##  $ flight        : int [1:336776] 1545 1714 1141 725 461 1696 507 5708 79 301 ...
##  $ tailnum       : chr [1:336776] &quot;N14228&quot; &quot;N24211&quot; &quot;N619AA&quot; &quot;N804JB&quot; ...
##  $ origin        : chr [1:336776] &quot;EWR&quot; &quot;LGA&quot; &quot;JFK&quot; &quot;JFK&quot; ...
##  $ dest          : chr [1:336776] &quot;IAH&quot; &quot;IAH&quot; &quot;MIA&quot; &quot;BQN&quot; ...
##  $ air_time      : num [1:336776] 227 227 160 183 116 150 158 53 140 138 ...
##  $ distance      : num [1:336776] 1400 1416 1089 1576 762 ...
##  $ hour          : num [1:336776] 5 5 5 5 6 5 6 6 6 6 ...
##  $ minute        : num [1:336776] 15 29 40 45 0 58 0 0 0 0 ...
##  $ time_hour     : POSIXct[1:336776], format: &quot;2013-01-01 05:00:00&quot; &quot;2013-01-01 05:00:00&quot; &quot;2013-01-01 05:00:00&quot; &quot;2013-01-01 05:00:00&quot; ...</code></pre>
<p>Gostaríamos de obter a média de atraso da chegada para cada mês. Para isso, primeiro agrupamos no nível necessário e depois sumarizamos.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="manipulando-os-dados.html#cb182-1" aria-hidden="true" tabindex="-1"></a>atraso_por_mes <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb182-2"><a href="manipulando-os-dados.html#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="manipulando-os-dados.html#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">arr_delay_media =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb182-4"><a href="manipulando-os-dados.html#cb182-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">dep_delay_media =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb182-5"><a href="manipulando-os-dados.html#cb182-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-6"><a href="manipulando-os-dados.html#cb182-6" aria-hidden="true" tabindex="-1"></a>atraso_por_mes</span></code></pre></div>
<pre><code>## # A tibble: 12 × 3
##    month arr_delay_media dep_delay_media
##    &lt;int&gt;           &lt;dbl&gt;           &lt;dbl&gt;
##  1     1           6.13            10.0 
##  2     2           5.61            10.8 
##  3     3           5.81            13.2 
##  4     4          11.2             13.9 
##  5     5           3.52            13.0 
##  6     6          16.5             20.8 
##  7     7          16.7             21.7 
##  8     8           6.04            12.6 
##  9     9          -4.02             6.72
## 10    10          -0.167            6.24
## 11    11           0.461            5.44
## 12    12          14.9             16.6</code></pre>
<p>A função <code>n()</code> retorna a quantidade de observacões (linhas) por variável especificada em <code>group_by()</code>:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="manipulando-os-dados.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantidade de voos por hora do dia</span></span>
<span id="cb184-2"><a href="manipulando-os-dados.html#cb184-2" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb184-3"><a href="manipulando-os-dados.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(carrier) <span class="sc">%&gt;%</span> </span>
<span id="cb184-4"><a href="manipulando-os-dados.html#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_voos =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb184-5"><a href="manipulando-os-dados.html#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   carrier n_voos
##   &lt;chr&gt;    &lt;int&gt;
## 1 9E       18460
## 2 AA       32729
## 3 AS         714
## 4 B6       54635
## 5 DL       48110
## 6 EV       54173</code></pre>
<p>A função <code>n_distinct()</code> retorna a quantidade de casos únicos por grupo:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="manipulando-os-dados.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quantas companhias aéreas diferentes operam por aeroporto por mês nos EUA?</span></span>
<span id="cb186-2"><a href="manipulando-os-dados.html#cb186-2" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb186-3"><a href="manipulando-os-dados.html#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin, month) <span class="sc">%&gt;%</span> </span>
<span id="cb186-4"><a href="manipulando-os-dados.html#cb186-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_empresas =</span> <span class="fu">n_distinct</span>(carrier)) <span class="sc">%&gt;%</span> </span>
<span id="cb186-5"><a href="manipulando-os-dados.html#cb186-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">6</span>)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;origin&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 6 × 3
## # Groups:   origin [1]
##   origin month n_empresas
##   &lt;chr&gt;  &lt;int&gt;      &lt;int&gt;
## 1 EWR        1         10
## 2 EWR        2         10
## 3 EWR        3         10
## 4 EWR        4         11
## 5 EWR        5         11
## 6 EWR        6         12</code></pre>
<div class="rmdtip">
<p><strong>Referências:</strong>
<a href="https://dplyr.tidyverse.org/reference/group_by.html">Documentação da função <code>group_by()</code></a><br />
<a href="https://dplyr.tidyverse.org/reference/summarise.html">Documentação da função <code>summarise()</code></a></p>
</div>
</div>
<div id="arrange" class="section level3" number="4.4.6">
<h3><span class="header-section-number">4.4.6</span> Arrange</h3>
<p>A função <code>arrange()</code> serve para organizar os dados em sua ordenação. Costuma ser uma das últimas operações, normalmente usada para organizar os dados e facilitar visualizações ou criação de relatórios. Utilizando o exemplo anterior, gostaríamos de ordenar os meses pelas menores médias de decolagem (para ordens decrescentes basta usar o sinal de menos <code>-</code>)</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="manipulando-os-dados.html#cb189-1" aria-hidden="true" tabindex="-1"></a>media <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb189-2"><a href="manipulando-os-dados.html#cb189-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb189-3"><a href="manipulando-os-dados.html#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">arr_delay_media =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb189-4"><a href="manipulando-os-dados.html#cb189-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">dep_delay_media =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb189-5"><a href="manipulando-os-dados.html#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(dep_delay_media)</span>
<span id="cb189-6"><a href="manipulando-os-dados.html#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="manipulando-os-dados.html#cb189-7" aria-hidden="true" tabindex="-1"></a>media</span></code></pre></div>
<pre><code>## # A tibble: 12 × 3
##    month arr_delay_media dep_delay_media
##    &lt;int&gt;           &lt;dbl&gt;           &lt;dbl&gt;
##  1    11           0.461            5.44
##  2    10          -0.167            6.24
##  3     9          -4.02             6.72
##  4     1           6.13            10.0 
##  5     2           5.61            10.8 
##  6     8           6.04            12.6 
##  7     5           3.52            13.0 
##  8     3           5.81            13.2 
##  9     4          11.2             13.9 
## 10    12          14.9             16.6 
## 11     6          16.5             20.8 
## 12     7          16.7             21.7</code></pre>
<div class="rmdtip">
<p><strong>Referências:</strong>
<a href="https://dplyr.tidyverse.org/reference/arrange.html">Documentação da função <code>arrange()</code></a></p>
</div>
</div>
</div>
<div id="exercícios-2" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Exercícios</h2>
<div id="parte-1" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Parte 1</h3>
<ol style="list-style-type: decimal">
<li><p>Quais foram os deputados com mais despesas na cota parlamentar (considerando a coluna vlrDocumento)?</p></li>
<li><p>Quais foram as 5 empresas mais contratadas (considerando a coluna textCNPJCPF)?</p></li>
<li><p>Qual foi o gasto médio dos deputados, por UF, com a cota parlamentar (considerando a coluna vlrDocumento)?</p></li>
<li><p>Quais categorias de gastos registraram mais despesas nas lideranças (considerando a coluna txtDescricao)?</p></li>
<li><p>Quantas linhas da coluna com o PDF da nota fiscal estão com NA (considerando a coluna urlDocumento)?</p></li>
<li><p>Qual foi o mês com menos gastos (considerando a coluna numMes)?</p></li>
</ol>
</div>
<div id="parte-2" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Parte 2</h3>
<p>Baixe o dataset de anúncios do AirBNB no Rio de Janeiro a partir deste link:</p>
<p><a href="http://data.insideairbnb.com/brazil/rj/rio-de-janeiro/2021-07-17/data/listings.csv.gz" class="uri">http://data.insideairbnb.com/brazil/rj/rio-de-janeiro/2021-07-17/data/listings.csv.gz</a></p>
<ol style="list-style-type: decimal">
<li>Leia o arquivo listings com a função read_csv() e salve no objeto <code>df_anuncios</code><br />
</li>
<li>Inspecione os dados: funções <code>summary()</code> e <code>glimpse()</code><br />
</li>
<li>A partir do output de <code>glimpse()</code>, explique as diferentes classes de objetos no R.<br />
</li>
<li>Observe o problema nas variáveis de preço<br />
</li>
<li>Retorne a url (scrape_url) do anúncio mais caro do airbnb<br />
</li>
<li>Retorne o nome do host (host_name) que tem a maior quantidade de anúncios<br />
</li>
<li>Retorne a quantidade de hosts por ano em que entrou no airbnb<br />
</li>
<li>Selecione as colunas name e space e filtre as linhas que contem a palavra praia em space. Dica: Vc pode usar a função <code>str_detect()</code> dentro de <code>filter()</code> ou de <code>mutate()</code><br />
</li>
<li>Imóveis que mencionam a palavra praia são em média mais caros?</li>
<li>Use <code>mutate()</code> para modificar o dataframe criando uma coluna booleana chamada <code>esgotado</code> informando se o imovel esta indisponivel para os proximos 30 dias (coluna availability_30)</li>
<li>Quais os 5 bairros que possuem mais de 100 anúncios com a maior taxa de anúncios esgotados nos próximos 30 dias? Dica: crie duas colunas com summarise, uma usando n() e outra com mean(esgotado) e depois use filter(), arrange() e head()</li>
<li>Retorne a quantidade de anúncios e reviews (number_of_reviews) por bairro, calcule uma taxa de quantidade de reviews por quantidade de anuncios. Os bairros que possuem mais anuncios são, proporcionalmente, os que tem mais reviews?</li>
<li>Quais são os diferentes tipos de anúncio (quarto, apt, etc.) que existem? (Coluna room_type)</li>
<li>A quantidade de quartos tem relação com o preço dos apartamentos inteiros?</li>
<li>DESAFIO
Suponha que você planeja uma viagem para o RJ com mais 1 pessoa de 5 diárias nos…
proximos 30 dias. Você e seu grupo têm alguns critérios de escolha:</li>
</ol>
<ul>
<li>Vocês querem ficar em Ipanema, Copacabana ou Leblon.<br />
</li>
<li>Vocês preferem que o host esteja no mesmo bairro.<br />
</li>
<li>Não desejam pagar um depósito de segurança;<br />
</li>
<li>Querem um apartamento inteiro só para vocês que seja “instant bookable”<br />
</li>
<li>A diária já inclua duas pessoas</li>
</ul>
<p>Filtre os anúncios que atendem aos critérios acima e crie uma coluna chamada preco_total_viagem,
com a formula sendo: taxa de limpeza + preço da diaria x quantidade de diarias.
Compare os resultados com os do site.
Dica: Comece com o código abaixo, selecionando as colunas importantes</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="manipulando-os-dados.html#cb191-1" aria-hidden="true" tabindex="-1"></a>df_anuncios <span class="sc">%&gt;%</span> </span>
<span id="cb191-2"><a href="manipulando-os-dados.html#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(listing_url, neighbourhood, host_neighbourhood,</span>
<span id="cb191-3"><a href="manipulando-os-dados.html#cb191-3" aria-hidden="true" tabindex="-1"></a>         availability_30, minimum_nights, </span>
<span id="cb191-4"><a href="manipulando-os-dados.html#cb191-4" aria-hidden="true" tabindex="-1"></a>         security_deposit, instant_bookable,</span>
<span id="cb191-5"><a href="manipulando-os-dados.html#cb191-5" aria-hidden="true" tabindex="-1"></a>         guests_included, price, room_type, number_of_reviews,</span>
<span id="cb191-6"><a href="manipulando-os-dados.html#cb191-6" aria-hidden="true" tabindex="-1"></a>         cleaning_fee, review_scores_rating)</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lendo-os-dados.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="limpando-dados.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cdr-intro.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
