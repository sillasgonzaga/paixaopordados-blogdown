<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Estruturas complexas de dados | Ciência de Dados com R - Introdução</title>
  <meta name="description" content="Aprendendo a programar com R" />
  <meta name="generator" content="bookdown 0.18.1 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Estruturas complexas de dados | Ciência de Dados com R - Introdução" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Aprendendo a programar com R" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Estruturas complexas de dados | Ciência de Dados com R - Introdução" />
  
  <meta name="twitter:description" content="Aprendendo a programar com R" />
  

<meta name="author" content="Saulo Guerra, Paulo Felipe de Oliveira, Robert McDonnell e Sillas Gonzaga" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="obtendo-dados.html"/>
<link rel="next" href="ggplot2.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.9000/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-61574597-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-61574597-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Ciência de Dados com R - Introdução</a></li>
<img src="hexcdr.png" class="hexcurso" alt="hex">

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a></li>
<li class="chapter" data-level="1" data-path="introdução.html"><a href="introdução.html"><i class="fa fa-check"></i><b>1</b> Introdução</a><ul>
<li class="chapter" data-level="1.1" data-path="introdução.html"><a href="introdução.html#o-que-é-ciência-de-dados"><i class="fa fa-check"></i><b>1.1</b> O que é Ciência de Dados?</a></li>
<li class="chapter" data-level="1.2" data-path="introdução.html"><a href="introdução.html#workflow-da-ciência-de-dados"><i class="fa fa-check"></i><b>1.2</b> Workflow da Ciência de Dados</a></li>
<li class="chapter" data-level="1.3" data-path="introdução.html"><a href="introdução.html#linguagens-para-ciência-de-dados"><i class="fa fa-check"></i><b>1.3</b> Linguagens para Ciência de dados</a></li>
<li class="chapter" data-level="1.4" data-path="introdução.html"><a href="introdução.html#o-que-é-r-e-por-que-devo-aprendê-lo"><i class="fa fa-check"></i><b>1.4</b> O que é R e por que devo aprendê-lo?</a></li>
<li class="chapter" data-level="1.5" data-path="introdução.html"><a href="introdução.html#rstudio"><i class="fa fa-check"></i><b>1.5</b> RStudio</a></li>
<li class="chapter" data-level="1.6" data-path="introdução.html"><a href="introdução.html#buscando-ajuda"><i class="fa fa-check"></i><b>1.6</b> Buscando Ajuda</a></li>
<li class="chapter" data-level="1.7" data-path="introdução.html"><a href="introdução.html#exercícios"><i class="fa fa-check"></i><b>1.7</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html"><i class="fa fa-check"></i><b>2</b> Conceitos Básicos</a><ul>
<li class="chapter" data-level="2.1" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#console"><i class="fa fa-check"></i><b>2.1</b> Console</a></li>
<li class="chapter" data-level="2.2" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#scripts"><i class="fa fa-check"></i><b>2.2</b> Scripts</a><ul>
<li class="chapter" data-level="2.2.1" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#salvando-scripts"><i class="fa fa-check"></i><b>2.2.1</b> Salvando Scripts</a></li>
<li class="chapter" data-level="2.2.2" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#comentários-de-código"><i class="fa fa-check"></i><b>2.2.2</b> Comentários de Código</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#objetos-variáveis"><i class="fa fa-check"></i><b>2.3</b> Objetos (Variáveis)</a></li>
<li class="chapter" data-level="2.4" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#funções"><i class="fa fa-check"></i><b>2.4</b> Funções</a></li>
<li class="chapter" data-level="2.5" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#pacotes"><i class="fa fa-check"></i><b>2.5</b> Pacotes</a></li>
<li class="chapter" data-level="2.6" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#boas-práticas"><i class="fa fa-check"></i><b>2.6</b> Boas práticas</a></li>
<li class="chapter" data-level="2.7" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#tidyverse"><i class="fa fa-check"></i><b>2.7</b> Tidyverse</a></li>
<li class="chapter" data-level="2.8" data-path="conceitos-básicos.html"><a href="conceitos-básicos.html#exercícios-1"><i class="fa fa-check"></i><b>2.8</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html"><i class="fa fa-check"></i><b>3</b> Lendo os dados</a><ul>
<li class="chapter" data-level="3.1" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#tipos-de-estrutura-dos-dados"><i class="fa fa-check"></i><b>3.1</b> Tipos de Estrutura dos Dados</a><ul>
<li class="chapter" data-level="3.1.1" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#dados-estruturados"><i class="fa fa-check"></i><b>3.1.1</b> Dados Estruturados</a></li>
<li class="chapter" data-level="3.1.2" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#dados-não-estruturados"><i class="fa fa-check"></i><b>3.1.2</b> Dados Não Estruturados</a></li>
<li class="chapter" data-level="3.1.3" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#dados-semiestruturados"><i class="fa fa-check"></i><b>3.1.3</b> Dados Semiestruturados</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#definindo-o-local-dos-dados"><i class="fa fa-check"></i><b>3.2</b> Definindo o Local dos Dados</a></li>
<li class="chapter" data-level="3.3" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#pacote-para-leitura-dos-dados"><i class="fa fa-check"></i><b>3.3</b> Pacote para leitura dos dados</a></li>
<li class="chapter" data-level="3.4" data-path="lendo-os-dados.html"><a href="lendo-os-dados.html#exercícios-2"><i class="fa fa-check"></i><b>3.4</b> Exercícios:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html"><i class="fa fa-check"></i><b>4</b> Manipulando os dados</a><ul>
<li class="chapter" data-level="4.1" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#tipos-de-variáveis-e-colunas"><i class="fa fa-check"></i><b>4.1</b> Tipos de Variáveis e Colunas</a><ul>
<li class="chapter" data-level="4.1.1" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#conversões-de-tipos-de-variáveis"><i class="fa fa-check"></i><b>4.1.1</b> Conversões de tipos de variáveis</a></li>
<li class="chapter" data-level="4.1.2" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#outros-tipos-de-variáveis"><i class="fa fa-check"></i><b>4.1.2</b> Outros tipos de variáveis</a></li>
<li class="chapter" data-level="4.1.3" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#valores-faltantes-e-o-na"><i class="fa fa-check"></i><b>4.1.3</b> Valores faltantes e o ‘NA’</a></li>
<li class="chapter" data-level="4.1.4" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#estruturas-de-controle-de-fluxo"><i class="fa fa-check"></i><b>4.1.4</b> Estruturas de Controle de Fluxo</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#if-e-else"><i class="fa fa-check"></i><b>4.2</b> If e Else</a></li>
<li class="chapter" data-level="4.3" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#loops"><i class="fa fa-check"></i><b>4.3</b> Loops</a><ul>
<li class="chapter" data-level="4.3.1" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#for"><i class="fa fa-check"></i><b>4.3.1</b> For</a></li>
<li class="chapter" data-level="4.3.2" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#while"><i class="fa fa-check"></i><b>4.3.2</b> While</a></li>
<li class="chapter" data-level="4.3.3" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#funções-1"><i class="fa fa-check"></i><b>4.3.3</b> Funções</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#manipulações-com-r-base"><i class="fa fa-check"></i><b>4.4</b> Manipulações com R base</a><ul>
<li class="chapter" data-level="4.4.1" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#trabalhando-com-colunas-de-um-data.frame"><i class="fa fa-check"></i><b>4.4.1</b> Trabalhando com colunas de um data.frame</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#pacote-dplyr"><i class="fa fa-check"></i><b>4.5</b> Pacote dplyr</a><ul>
<li class="chapter" data-level="4.5.1" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#verbetes-do-dplyr-e-o-operador"><i class="fa fa-check"></i><b>4.5.1</b> Verbetes do dplyr e o operador <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#select"><i class="fa fa-check"></i><b>4.5.2</b> Select</a></li>
<li class="chapter" data-level="4.5.3" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#filter"><i class="fa fa-check"></i><b>4.5.3</b> Filter</a></li>
<li class="chapter" data-level="4.5.4" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#mutate"><i class="fa fa-check"></i><b>4.5.4</b> Mutate</a></li>
<li class="chapter" data-level="4.5.5" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#group-by-e-summarise"><i class="fa fa-check"></i><b>4.5.5</b> Group By e Summarise</a></li>
<li class="chapter" data-level="4.5.6" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#arrange"><i class="fa fa-check"></i><b>4.5.6</b> Arrange</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="manipulando-os-dados.html"><a href="manipulando-os-dados.html#exercícios-3"><i class="fa fa-check"></i><b>4.6</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="limpando-dados.html"><a href="limpando-dados.html"><i class="fa fa-check"></i><b>5</b> Limpando dados</a><ul>
<li class="chapter" data-level="5.1" data-path="limpando-dados.html"><a href="limpando-dados.html#o-formato-ideal-dos-dados"><i class="fa fa-check"></i><b>5.1</b> O formato “ideal” dos dados</a></li>
<li class="chapter" data-level="5.2" data-path="limpando-dados.html"><a href="limpando-dados.html#pacote-tidyr"><i class="fa fa-check"></i><b>5.2</b> Pacote tidyr</a><ul>
<li class="chapter" data-level="5.2.1" data-path="limpando-dados.html"><a href="limpando-dados.html#gather"><i class="fa fa-check"></i><b>5.2.1</b> gather</a></li>
<li class="chapter" data-level="5.2.2" data-path="limpando-dados.html"><a href="limpando-dados.html#spread"><i class="fa fa-check"></i><b>5.2.2</b> spread</a></li>
<li class="chapter" data-level="5.2.3" data-path="limpando-dados.html"><a href="limpando-dados.html#separate"><i class="fa fa-check"></i><b>5.2.3</b> separate</a></li>
<li class="chapter" data-level="5.2.4" data-path="limpando-dados.html"><a href="limpando-dados.html#unite"><i class="fa fa-check"></i><b>5.2.4</b> unite</a></li>
<li class="chapter" data-level="5.2.5" data-path="limpando-dados.html"><a href="limpando-dados.html#separate_rows"><i class="fa fa-check"></i><b>5.2.5</b> separate_rows</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="limpando-dados.html"><a href="limpando-dados.html#exercicios"><i class="fa fa-check"></i><b>5.3</b> Exercicios</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="juntando-dados.html"><a href="juntando-dados.html"><i class="fa fa-check"></i><b>6</b> Juntando dados</a><ul>
<li class="chapter" data-level="6.1" data-path="juntando-dados.html"><a href="juntando-dados.html#união-de-dados-union"><i class="fa fa-check"></i><b>6.1</b> União de dados (Union)</a></li>
<li class="chapter" data-level="6.2" data-path="juntando-dados.html"><a href="juntando-dados.html#cruzamento-de-dados-join"><i class="fa fa-check"></i><b>6.2</b> Cruzamento de Dados (Join)</a><ul>
<li class="chapter" data-level="6.2.1" data-path="juntando-dados.html"><a href="juntando-dados.html#inner-join-ou-apenas-join"><i class="fa fa-check"></i><b>6.2.1</b> Inner Join (ou apenas Join)</a></li>
<li class="chapter" data-level="6.2.2" data-path="juntando-dados.html"><a href="juntando-dados.html#left-outer-join"><i class="fa fa-check"></i><b>6.2.2</b> Left Outer Join</a></li>
<li class="chapter" data-level="6.2.3" data-path="juntando-dados.html"><a href="juntando-dados.html#right-outer-join"><i class="fa fa-check"></i><b>6.2.3</b> Right Outer Join</a></li>
<li class="chapter" data-level="6.2.4" data-path="juntando-dados.html"><a href="juntando-dados.html#full-outer-join"><i class="fa fa-check"></i><b>6.2.4</b> Full Outer Join</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="juntando-dados.html"><a href="juntando-dados.html#exercícios-4"><i class="fa fa-check"></i><b>6.3</b> Exercícios</a></li>
<li class="chapter" data-level="6.4" data-path="juntando-dados.html"><a href="juntando-dados.html#exercícios-gerais-do-tidyverse"><i class="fa fa-check"></i><b>6.4</b> Exercícios gerais do Tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html"><i class="fa fa-check"></i><b>7</b> Dados em strings (texto)</a><ul>
<li class="chapter" data-level="7.1" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#pacote-stringr"><i class="fa fa-check"></i><b>7.1</b> Pacote stringr</a><ul>
<li class="chapter" data-level="7.1.1" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#extrair-parte-de-uma-string"><i class="fa fa-check"></i><b>7.1.1</b> Extrair parte de uma string</a></li>
<li class="chapter" data-level="7.1.2" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#substituir-caracteres-em-um-string"><i class="fa fa-check"></i><b>7.1.2</b> Substituir caracteres em um string</a></li>
<li class="chapter" data-level="7.1.3" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#buscar-correspondências-em-um-string"><i class="fa fa-check"></i><b>7.1.3</b> Buscar correspondências em um string</a></li>
<li class="chapter" data-level="7.1.4" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#complementar-uma-string"><i class="fa fa-check"></i><b>7.1.4</b> Complementar uma string</a></li>
<li class="chapter" data-level="7.1.5" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#remover-espaços-em-branco-desnecessários"><i class="fa fa-check"></i><b>7.1.5</b> Remover espaços em branco desnecessários</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#regex"><i class="fa fa-check"></i><b>7.2</b> Regex</a></li>
<li class="chapter" data-level="7.3" data-path="dados-em-strings-texto.html"><a href="dados-em-strings-texto.html#exercícios-5"><i class="fa fa-check"></i><b>7.3</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="trabalhando-com-datas.html"><a href="trabalhando-com-datas.html"><i class="fa fa-check"></i><b>8</b> Trabalhando com datas</a><ul>
<li class="chapter" data-level="8.1" data-path="trabalhando-com-datas.html"><a href="trabalhando-com-datas.html#gerar-um-vetor-sequencial-de-datas"><i class="fa fa-check"></i><b>8.1</b> Gerar um vetor sequencial de datas</a></li>
<li class="chapter" data-level="8.2" data-path="trabalhando-com-datas.html"><a href="trabalhando-com-datas.html#parsear-datas-e-horários"><i class="fa fa-check"></i><b>8.2</b> ‘Parsear’ datas e horários</a></li>
<li class="chapter" data-level="8.3" data-path="trabalhando-com-datas.html"><a href="trabalhando-com-datas.html#extrair-componentes-de-uma-data"><i class="fa fa-check"></i><b>8.3</b> Extrair componentes de uma data</a></li>
<li class="chapter" data-level="8.4" data-path="trabalhando-com-datas.html"><a href="trabalhando-com-datas.html#operações-matemáticas-com-datas"><i class="fa fa-check"></i><b>8.4</b> Operações matemáticas com datas</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="escrevendo-dados.html"><a href="escrevendo-dados.html"><i class="fa fa-check"></i><b>9</b> Escrevendo dados</a><ul>
<li class="chapter" data-level="9.1" data-path="escrevendo-dados.html"><a href="escrevendo-dados.html#escrevendo-csv"><i class="fa fa-check"></i><b>9.1</b> Escrevendo csv</a></li>
<li class="chapter" data-level="9.2" data-path="escrevendo-dados.html"><a href="escrevendo-dados.html#rds"><i class="fa fa-check"></i><b>9.2</b> Rds</a></li>
<li class="chapter" data-level="9.3" data-path="escrevendo-dados.html"><a href="escrevendo-dados.html#escrevendo-outros-tipos-de-arquivos"><i class="fa fa-check"></i><b>9.3</b> Escrevendo outros tipos de arquivos</a></li>
<li class="chapter" data-level="9.4" data-path="escrevendo-dados.html"><a href="escrevendo-dados.html#exercícios-6"><i class="fa fa-check"></i><b>9.4</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="obtendo-dados.html"><a href="obtendo-dados.html"><i class="fa fa-check"></i><b>10</b> Obtendo dados</a><ul>
<li class="chapter" data-level="10.1" data-path="obtendo-dados.html"><a href="obtendo-dados.html#api"><i class="fa fa-check"></i><b>10.1</b> API</a></li>
<li class="chapter" data-level="10.2" data-path="obtendo-dados.html"><a href="obtendo-dados.html#web-scrapping"><i class="fa fa-check"></i><b>10.2</b> Web Scrapping</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html"><i class="fa fa-check"></i><b>11</b> Estruturas complexas de dados</a><ul>
<li class="chapter" data-level="11.1" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#introdução-a-listas"><i class="fa fa-check"></i><b>11.1</b> Introdução a listas</a></li>
<li class="chapter" data-level="11.2" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#introdução-ao-pacote-purrr"><i class="fa fa-check"></i><b>11.2</b> Introdução ao pacote purrr</a><ul>
<li class="chapter" data-level="11.2.1" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#map"><i class="fa fa-check"></i><b>11.2.1</b> <code>map()</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#funções-derivadas-de-map"><i class="fa fa-check"></i><b>11.2.2</b> Funções derivadas de <code>map()</code></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#ideia-de-projeto-aplicando-uma-série-de-funções-a-uma-lista-de-arquivos"><i class="fa fa-check"></i><b>11.3</b> Ideia de projeto: Aplicando uma série de funções a uma lista de arquivos</a></li>
<li class="chapter" data-level="11.4" data-path="estruturas-complexas-de-dados.html"><a href="estruturas-complexas-de-dados.html#referências"><i class="fa fa-check"></i><b>11.4</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>12</b> Visualizações de dados (ggplot2)</a><ul>
<li class="chapter" data-level="12.1" data-path="ggplot2.html"><a href="ggplot2.html#mapeamento-estético"><i class="fa fa-check"></i><b>12.1</b> Mapeamento Estético</a></li>
<li class="chapter" data-level="12.2" data-path="ggplot2.html"><a href="ggplot2.html#objetos-geométricos"><i class="fa fa-check"></i><b>12.2</b> Objetos geométricos</a></li>
<li class="chapter" data-level="12.3" data-path="ggplot2.html"><a href="ggplot2.html#escalas"><i class="fa fa-check"></i><b>12.3</b> Escalas</a><ul>
<li class="chapter" data-level="12.3.1" data-path="ggplot2.html"><a href="ggplot2.html#tipos-de-variáveis"><i class="fa fa-check"></i><b>12.3.1</b> Tipos de Variáveis</a></li>
<li class="chapter" data-level="12.3.2" data-path="ggplot2.html"><a href="ggplot2.html#eixos"><i class="fa fa-check"></i><b>12.3.2</b> Eixos</a></li>
<li class="chapter" data-level="12.3.3" data-path="ggplot2.html"><a href="ggplot2.html#escalas-de-cores-color-e-preenchimento-fill"><i class="fa fa-check"></i><b>12.3.3</b> Escalas de Cores (color) e Preenchimento (fill)</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ggplot2.html"><a href="ggplot2.html#subplots-facet"><i class="fa fa-check"></i><b>12.4</b> Subplots (facet)</a></li>
<li class="chapter" data-level="12.5" data-path="ggplot2.html"><a href="ggplot2.html#temas"><i class="fa fa-check"></i><b>12.5</b> Temas</a><ul>
<li class="chapter" data-level="12.5.1" data-path="ggplot2.html"><a href="ggplot2.html#temas-disponíveis-no-ggplot2"><i class="fa fa-check"></i><b>12.5.1</b> Temas disponíveis no ggplot2</a></li>
<li class="chapter" data-level="12.5.2" data-path="ggplot2.html"><a href="ggplot2.html#temas-no-pacote-ggthemes"><i class="fa fa-check"></i><b>12.5.2</b> Temas no pacote ggthemes</a></li>
<li class="chapter" data-level="12.5.3" data-path="ggplot2.html"><a href="ggplot2.html#hrbrthemes"><i class="fa fa-check"></i><b>12.5.3</b> hrbrthemes</a></li>
<li class="chapter" data-level="12.5.4" data-path="ggplot2.html"><a href="ggplot2.html#setando-o-tema-globalmente"><i class="fa fa-check"></i><b>12.5.4</b> Setando o tema globalmente</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="ggplot2.html"><a href="ggplot2.html#legendas"><i class="fa fa-check"></i><b>12.6</b> Legendas</a></li>
<li class="chapter" data-level="12.7" data-path="ggplot2.html"><a href="ggplot2.html#escolhendo-o-tipo-de-gráfico"><i class="fa fa-check"></i><b>12.7</b> Escolhendo o tipo de gráfico</a></li>
<li class="chapter" data-level="12.8" data-path="ggplot2.html"><a href="ggplot2.html#gráfico-de-dispersão-geom_point"><i class="fa fa-check"></i><b>12.8</b> Gráfico de Dispersão (<code>geom_point()</code>)</a></li>
<li class="chapter" data-level="12.9" data-path="ggplot2.html"><a href="ggplot2.html#gráficos-de-bolhas"><i class="fa fa-check"></i><b>12.9</b> Gráficos de Bolhas</a></li>
<li class="chapter" data-level="12.10" data-path="ggplot2.html"><a href="ggplot2.html#gráficos-de-barras"><i class="fa fa-check"></i><b>12.10</b> Gráficos de Barras</a></li>
<li class="chapter" data-level="12.11" data-path="ggplot2.html"><a href="ggplot2.html#gráficos-de-linhas"><i class="fa fa-check"></i><b>12.11</b> Gráficos de linhas</a></li>
<li class="chapter" data-level="12.12" data-path="ggplot2.html"><a href="ggplot2.html#histogramas-e-freqpoly"><i class="fa fa-check"></i><b>12.12</b> Histogramas e freqpoly</a></li>
<li class="chapter" data-level="12.13" data-path="ggplot2.html"><a href="ggplot2.html#boxplots-jitterplots-e-violinplots"><i class="fa fa-check"></i><b>12.13</b> Boxplots, jitterplots e violinplots</a></li>
<li class="chapter" data-level="12.14" data-path="ggplot2.html"><a href="ggplot2.html#anotações"><i class="fa fa-check"></i><b>12.14</b> Anotações</a></li>
<li class="chapter" data-level="12.15" data-path="ggplot2.html"><a href="ggplot2.html#cleveland-dot-plot"><i class="fa fa-check"></i><b>12.15</b> Cleveland Dot Plot</a></li>
<li class="chapter" data-level="12.16" data-path="ggplot2.html"><a href="ggplot2.html#textosrótulos"><i class="fa fa-check"></i><b>12.16</b> Textos/Rótulos</a></li>
<li class="chapter" data-level="12.17" data-path="ggplot2.html"><a href="ggplot2.html#plotando-funções"><i class="fa fa-check"></i><b>12.17</b> Plotando funções</a></li>
<li class="chapter" data-level="12.18" data-path="ggplot2.html"><a href="ggplot2.html#mapas-plotando-polígonos"><i class="fa fa-check"></i><b>12.18</b> Mapas: plotando polígonos</a><ul>
<li class="chapter" data-level="12.18.1" data-path="ggplot2.html"><a href="ggplot2.html#projeto-plotando-indicadores-socioeconômicos-em-um-mapa."><i class="fa fa-check"></i><b>12.18.1</b> Projeto: plotando indicadores socioeconômicos em um mapa.</a></li>
</ul></li>
<li class="chapter" data-level="12.19" data-path="ggplot2.html"><a href="ggplot2.html#salvando-gráficos"><i class="fa fa-check"></i><b>12.19</b> Salvando Gráficos</a></li>
<li class="chapter" data-level="12.20" data-path="ggplot2.html"><a href="ggplot2.html#extensões-do-ggplot2"><i class="fa fa-check"></i><b>12.20</b> Extensões do ggplot2</a><ul>
<li class="chapter" data-level="12.20.1" data-path="ggplot2.html"><a href="ggplot2.html#ggrepel"><i class="fa fa-check"></i><b>12.20.1</b> ggrepel</a></li>
<li class="chapter" data-level="12.20.2" data-path="ggplot2.html"><a href="ggplot2.html#gganimate"><i class="fa fa-check"></i><b>12.20.2</b> gganimate</a></li>
</ul></li>
<li class="chapter" data-level="12.21" data-path="ggplot2.html"><a href="ggplot2.html#exercícios-7"><i class="fa fa-check"></i><b>12.21</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="htmlwidgets.html"><a href="htmlwidgets.html"><i class="fa fa-check"></i><b>13</b> Visualizações Interativas</a><ul>
<li class="chapter" data-level="13.1" data-path="htmlwidgets.html"><a href="htmlwidgets.html#introdução-1"><i class="fa fa-check"></i><b>13.1</b> Introdução</a></li>
<li class="chapter" data-level="13.2" data-path="htmlwidgets.html"><a href="htmlwidgets.html#plotly"><i class="fa fa-check"></i><b>13.2</b> Plotly</a></li>
<li class="chapter" data-level="13.3" data-path="htmlwidgets.html"><a href="htmlwidgets.html#dygraphs"><i class="fa fa-check"></i><b>13.3</b> dygraphs</a></li>
<li class="chapter" data-level="13.4" data-path="htmlwidgets.html"><a href="htmlwidgets.html#leaflet"><i class="fa fa-check"></i><b>13.4</b> Leaflet</a><ul>
<li class="chapter" data-level="13.4.1" data-path="htmlwidgets.html"><a href="htmlwidgets.html#primeiro-exemplo"><i class="fa fa-check"></i><b>13.4.1</b> Primeiro exemplo</a></li>
<li class="chapter" data-level="13.4.2" data-path="htmlwidgets.html"><a href="htmlwidgets.html#marcadores"><i class="fa fa-check"></i><b>13.4.2</b> Marcadores</a></li>
<li class="chapter" data-level="13.4.3" data-path="htmlwidgets.html"><a href="htmlwidgets.html#polígonos"><i class="fa fa-check"></i><b>13.4.3</b> Polígonos</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="htmlwidgets.html"><a href="htmlwidgets.html#exercícios-8"><i class="fa fa-check"></i><b>13.5</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>14</b> RMarkdown</a><ul>
<li class="chapter" data-level="14.1" data-path="rmarkdown.html"><a href="rmarkdown.html#usos-do-rmarkdown"><i class="fa fa-check"></i><b>14.1</b> Usos do RMarkdown</a></li>
<li class="chapter" data-level="14.2" data-path="rmarkdown.html"><a href="rmarkdown.html#estrutura-de-um-rmarkdown"><i class="fa fa-check"></i><b>14.2</b> Estrutura de um RMarkdown</a></li>
<li class="chapter" data-level="14.3" data-path="rmarkdown.html"><a href="rmarkdown.html#renderizando-um-documento"><i class="fa fa-check"></i><b>14.3</b> Renderizando um documento</a></li>
<li class="chapter" data-level="14.4" data-path="rmarkdown.html"><a href="rmarkdown.html#sintaxe"><i class="fa fa-check"></i><b>14.4</b> Sintaxe</a></li>
<li class="chapter" data-level="14.5" data-path="rmarkdown.html"><a href="rmarkdown.html#opções-de-chunk"><i class="fa fa-check"></i><b>14.5</b> Opções de Chunk</a></li>
<li class="chapter" data-level="14.6" data-path="rmarkdown.html"><a href="rmarkdown.html#principais-formatos"><i class="fa fa-check"></i><b>14.6</b> Principais Formatos</a><ul>
<li class="chapter" data-level="14.6.1" data-path="rmarkdown.html"><a href="rmarkdown.html#html"><i class="fa fa-check"></i><b>14.6.1</b> HTML</a></li>
<li class="chapter" data-level="14.6.2" data-path="rmarkdown.html"><a href="rmarkdown.html#pdf"><i class="fa fa-check"></i><b>14.6.2</b> PDF</a></li>
<li class="chapter" data-level="14.6.3" data-path="rmarkdown.html"><a href="rmarkdown.html#word"><i class="fa fa-check"></i><b>14.6.3</b> Word</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="rmarkdown.html"><a href="rmarkdown.html#excercícios"><i class="fa fa-check"></i><b>14.7</b> Excercícios</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="modelos.html"><a href="modelos.html"><i class="fa fa-check"></i><b>15</b> Modelos</a><ul>
<li class="chapter" data-level="15.1" data-path="modelos.html"><a href="modelos.html#modelo-linear"><i class="fa fa-check"></i><b>15.1</b> Modelo Linear</a><ul>
<li class="chapter" data-level="15.1.1" data-path="modelos.html"><a href="modelos.html#regressão"><i class="fa fa-check"></i><b>15.1.1</b> Regressão</a></li>
<li class="chapter" data-level="15.1.2" data-path="modelos.html"><a href="modelos.html#classificação"><i class="fa fa-check"></i><b>15.1.2</b> Classificação</a></li>
<li class="chapter" data-level="15.1.3" data-path="modelos.html"><a href="modelos.html#classificação-com-modelos-baseados-em-árvores"><i class="fa fa-check"></i><b>15.1.3</b> Classificação com modelos baseados em árvores</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="modelos.html"><a href="modelos.html#exercícios-9"><i class="fa fa-check"></i><b>15.2</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="revisão-titanic.html"><a href="revisão-titanic.html"><i class="fa fa-check"></i><b>16</b> Revisão - Titanic</a><ul>
<li class="chapter" data-level="16.1" data-path="revisão-titanic.html"><a href="revisão-titanic.html#objetivo"><i class="fa fa-check"></i><b>16.1</b> Objetivo</a></li>
<li class="chapter" data-level="16.2" data-path="revisão-titanic.html"><a href="revisão-titanic.html#carregando-os-dados"><i class="fa fa-check"></i><b>16.2</b> Carregando os Dados</a></li>
<li class="chapter" data-level="16.3" data-path="revisão-titanic.html"><a href="revisão-titanic.html#manipulando-os-dados-1"><i class="fa fa-check"></i><b>16.3</b> Manipulando os dados</a><ul>
<li class="chapter" data-level="16.3.1" data-path="revisão-titanic.html"><a href="revisão-titanic.html#variável-survived"><i class="fa fa-check"></i><b>16.3.1</b> Variável Survived</a></li>
<li class="chapter" data-level="16.3.2" data-path="revisão-titanic.html"><a href="revisão-titanic.html#variável-name"><i class="fa fa-check"></i><b>16.3.2</b> Variável Name</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="revisão-titanic.html"><a href="revisão-titanic.html#idade"><i class="fa fa-check"></i><b>16.4</b> Idade</a><ul>
<li class="chapter" data-level="16.4.1" data-path="revisão-titanic.html"><a href="revisão-titanic.html#exercício"><i class="fa fa-check"></i><b>16.4.1</b> Exercício</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="revisão-titanic.html"><a href="revisão-titanic.html#visualizações"><i class="fa fa-check"></i><b>16.5</b> Visualizações</a></li>
<li class="chapter" data-level="16.6" data-path="revisão-titanic.html"><a href="revisão-titanic.html#modelo-preditivo"><i class="fa fa-check"></i><b>16.6</b> Modelo Preditivo</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="referências-1.html"><a href="referências-1.html"><i class="fa fa-check"></i><b>17</b> Referências</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado com bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ciência de Dados com R - Introdução</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estruturas-complexas-de-dados" class="section level1">
<h1><span class="header-section-number">11</span> Estruturas complexas de dados</h1>
<div id="introdução-a-listas" class="section level2">
<h2><span class="header-section-number">11.1</span> Introdução a listas</h2>
<p>Nós já falamos sobre vetores, que são as principais estruturas unidimensionais de dados e que só aceitam elementos da mesma classe:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb433-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">&quot;c&quot;</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb433-2" data-line-number="2"><span class="kw">class</span>(a)</a></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>O R também possui uma estrutura de dados que pode armazenar, literalmente, qualquer tipo de objeto: as listas, criadas com a função <code>list()</code>.</p>
<p>No exemplo abaixo uma série de objetos de classes diferentes são armazenadas:</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb435-1" data-line-number="1">data_frame &lt;-<span class="st"> </span><span class="kw">head</span>(iris)</a>
<a class="sourceLine" id="cb435-2" data-line-number="2">elemento_unico_inteiro &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb435-3" data-line-number="3">um_na &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb435-4" data-line-number="4">vetor_string &lt;-<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb435-5" data-line-number="5">modelo_regressao &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb435-6" data-line-number="6"></a>
<a class="sourceLine" id="cb435-7" data-line-number="7">minha_lista &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data_frame =</span> data_frame, </a>
<a class="sourceLine" id="cb435-8" data-line-number="8">                    <span class="dt">elemento_unico_inteiro =</span> elemento_unico_inteiro, </a>
<a class="sourceLine" id="cb435-9" data-line-number="9">                    <span class="co"># este elemento abaixo não vai possuir um nome</span></a>
<a class="sourceLine" id="cb435-10" data-line-number="10">                    um_na, </a>
<a class="sourceLine" id="cb435-11" data-line-number="11">                    <span class="dt">vetor_string =</span> vetor_string,</a>
<a class="sourceLine" id="cb435-12" data-line-number="12">                    <span class="dt">modelo_regressao =</span> modelo_regressao)</a>
<a class="sourceLine" id="cb435-13" data-line-number="13"></a>
<a class="sourceLine" id="cb435-14" data-line-number="14"><span class="co"># Conferindo o output: </span></a>
<a class="sourceLine" id="cb435-15" data-line-number="15">minha_lista</a></code></pre></div>
<pre><code>## $data_frame
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa
## 
## $elemento_unico_inteiro
## [1] 1
## 
## [[3]]
## [1] NA
## 
## $vetor_string
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot;
## 
## $modelo_regressao
## 
## Call:
## lm(formula = mpg ~ wt, data = mtcars)
## 
## Coefficients:
## (Intercept)           wt  
##      37.285       -5.344</code></pre>
<p>Pelo output já percebemos que a maneira como extraímos um elemento de um vetor é diferente da de uma lista. No primeiro, usamos um par de colchetes (<code>[]</code>), no segundo usamos dois pares (<code>[[]]</code>) ou também cifrão (<code>$</code>), que só funciona caso o elemento da lista possua um nome.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb437-1" data-line-number="1">minha_lista[[<span class="dv">2</span>]]</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb439-1" data-line-number="1">minha_lista<span class="op">$</span>vetor_string</a></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot;</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb441-1" data-line-number="1"><span class="co"># o comando abaixo retorna NULL pq &quot;um_na&quot; não é um nome de</span></a>
<a class="sourceLine" id="cb441-2" data-line-number="2"><span class="co"># nenhum elemento da lista</span></a>
<a class="sourceLine" id="cb441-3" data-line-number="3">minha_lista<span class="op">$</span>um_na</a></code></pre></div>
<pre><code>## NULL</code></pre>
<p>Vetores podem ser transformandos em listas usando a função de coerção <code>as.list()</code>:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb443-1" data-line-number="1"><span class="kw">as.list</span>(vetor_string)</a></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;a&quot;
## 
## [[2]]
## [1] &quot;b&quot;
## 
## [[3]]
## [1] &quot;c&quot;
## 
## [[4]]
## [1] &quot;d&quot;
## 
## [[5]]
## [1] &quot;e&quot;</code></pre>
<p>Inserir um nome em uma lista é simples com o uso da função <code>names()</code>, que pode alterar os nomes da lista inteira ou de apenas um elemento, como no exemplo abaixo:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" data-line-number="1"><span class="kw">names</span>(minha_lista)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;meu_na&quot;</span></a>
<a class="sourceLine" id="cb445-2" data-line-number="2"><span class="kw">names</span>(minha_lista)</a></code></pre></div>
<pre><code>## [1] &quot;data_frame&quot;             &quot;elemento_unico_inteiro&quot; &quot;meu_na&quot;                 &quot;vetor_string&quot;           &quot;modelo_regressao&quot;</code></pre>
<p>A função <code>str()</code> pode user usada para inspecionar a estrutura da lista:</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" data-line-number="1"><span class="kw">str</span>(minha_lista)</a></code></pre></div>
<pre><code>## List of 5
##  $ data_frame            :&#39;data.frame&#39;:  6 obs. of  5 variables:
##   ..$ Sepal.Length: num [1:6] 5.1 4.9 4.7 4.6 5 5.4
##   ..$ Sepal.Width : num [1:6] 3.5 3 3.2 3.1 3.6 3.9
##   ..$ Petal.Length: num [1:6] 1.4 1.4 1.3 1.5 1.4 1.7
##   ..$ Petal.Width : num [1:6] 0.2 0.2 0.2 0.2 0.2 0.4
##   ..$ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1
##  $ elemento_unico_inteiro: num 1
##  $ meu_na                : logi NA
##  $ vetor_string          : chr [1:5] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; ...
##  $ modelo_regressao      :List of 12
##   ..$ coefficients : Named num [1:2] 37.29 -5.34
##   .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;(Intercept)&quot; &quot;wt&quot;
##   ..$ residuals    : Named num [1:32] -2.28 -0.92 -2.09 1.3 -0.2 ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:32] &quot;Mazda RX4&quot; &quot;Mazda RX4 Wag&quot; &quot;Datsun 710&quot; &quot;Hornet 4 Drive&quot; ...
##   ..$ effects      : Named num [1:32] -113.65 -29.116 -1.661 1.631 0.111 ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:32] &quot;(Intercept)&quot; &quot;wt&quot; &quot;&quot; &quot;&quot; ...
##   ..$ rank         : int 2
##   ..$ fitted.values: Named num [1:32] 23.3 21.9 24.9 20.1 18.9 ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:32] &quot;Mazda RX4&quot; &quot;Mazda RX4 Wag&quot; &quot;Datsun 710&quot; &quot;Hornet 4 Drive&quot; ...
##   ..$ assign       : int [1:2] 0 1
##   ..$ qr           :List of 5
##   .. ..$ qr   : num [1:32, 1:2] -5.657 0.177 0.177 0.177 0.177 ...
##   .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. ..$ : chr [1:32] &quot;Mazda RX4&quot; &quot;Mazda RX4 Wag&quot; &quot;Datsun 710&quot; &quot;Hornet 4 Drive&quot; ...
##   .. .. .. ..$ : chr [1:2] &quot;(Intercept)&quot; &quot;wt&quot;
##   .. .. ..- attr(*, &quot;assign&quot;)= int [1:2] 0 1
##   .. ..$ qraux: num [1:2] 1.18 1.05
##   .. ..$ pivot: int [1:2] 1 2
##   .. ..$ tol  : num 1e-07
##   .. ..$ rank : int 2
##   .. ..- attr(*, &quot;class&quot;)= chr &quot;qr&quot;
##   ..$ df.residual  : int 30
##   ..$ xlevels      : Named list()
##   ..$ call         : language lm(formula = mpg ~ wt, data = mtcars)
##   ..$ terms        :Classes &#39;terms&#39;, &#39;formula&#39;  language mpg ~ wt
##   .. .. ..- attr(*, &quot;variables&quot;)= language list(mpg, wt)
##   .. .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
##   .. .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. .. ..$ : chr [1:2] &quot;mpg&quot; &quot;wt&quot;
##   .. .. .. .. ..$ : chr &quot;wt&quot;
##   .. .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;wt&quot;
##   .. .. ..- attr(*, &quot;order&quot;)= int 1
##   .. .. ..- attr(*, &quot;intercept&quot;)= int 1
##   .. .. ..- attr(*, &quot;response&quot;)= int 1
##   .. .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. .. ..- attr(*, &quot;predvars&quot;)= language list(mpg, wt)
##   .. .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mpg&quot; &quot;wt&quot;
##   ..$ model        :&#39;data.frame&#39;:    32 obs. of  2 variables:
##   .. ..$ mpg: num [1:32] 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##   .. ..$ wt : num [1:32] 2.62 2.88 2.32 3.21 3.44 ...
##   .. ..- attr(*, &quot;terms&quot;)=Classes &#39;terms&#39;, &#39;formula&#39;  language mpg ~ wt
##   .. .. .. ..- attr(*, &quot;variables&quot;)= language list(mpg, wt)
##   .. .. .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
##   .. .. .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. .. .. ..$ : chr [1:2] &quot;mpg&quot; &quot;wt&quot;
##   .. .. .. .. .. ..$ : chr &quot;wt&quot;
##   .. .. .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;wt&quot;
##   .. .. .. ..- attr(*, &quot;order&quot;)= int 1
##   .. .. .. ..- attr(*, &quot;intercept&quot;)= int 1
##   .. .. .. ..- attr(*, &quot;response&quot;)= int 1
##   .. .. .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. .. .. ..- attr(*, &quot;predvars&quot;)= language list(mpg, wt)
##   .. .. .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mpg&quot; &quot;wt&quot;
##   ..- attr(*, &quot;class&quot;)= chr &quot;lm&quot;</code></pre>
<p>A maneira mais produtiva de se usar listas em seus projetos é para automatizar a aplicação de uma determinada função (ou funções) para todos os elementos de uma lista. Suponha, por exemplo, que você precise importar dezenas de arquivos csv, fazer algumas limpezas e manipulações de dados, construir modelos de Machine Learning e depois salvar os resultados no computador. Seria muito tedioso fazer isso manualmente, mas é para esse tipo de operação que listas se tornam muito úteis.</p>
<p>O pacote <code>purrr</code> possui uma série de comandos para aplicar funções a elementos de uma lista. O R base até possui as funções da família <em>apply</em> (<code>apply()</code>, <code>tapply()</code>, <code>lapply()</code>, etc), mas estas estão entrando em desuso devido à adoção do <code>purrr</code>.</p>
</div>
<div id="introdução-ao-pacote-purrr" class="section level2">
<h2><span class="header-section-number">11.2</span> Introdução ao pacote purrr</h2>
<div id="map" class="section level3">
<h3><span class="header-section-number">11.2.1</span> <code>map()</code></h3>
<p>Nós já vimos que o R aplica uma função a cada elemento de um vetor de uma forma muito simples:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb449-1" data-line-number="1">meu_vetor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">-3</span>, <span class="dv">5</span>, <span class="dv">-10</span>)</a>
<a class="sourceLine" id="cb449-2" data-line-number="2"><span class="co"># extrair o modulo de cada elemento do vetor acima</span></a>
<a class="sourceLine" id="cb449-3" data-line-number="3"><span class="kw">abs</span>(meu_vetor)</a></code></pre></div>
<pre><code>## [1]  1  3  5 10</code></pre>
<p>No caso de listas, não é bem assim que funciona:</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb451-1" data-line-number="1">minha_lista &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb451-2" data-line-number="2"><span class="kw">abs</span>(minha_lista)</a></code></pre></div>
<pre><code>## Error in abs(minha_lista): non-numeric argument to mathematical function</code></pre>
<p>É necessário usar uma outra função para aplicar uma função a cada elemento da lista. É aqui que introduzimos a função <code>map()</code>, do pacote <code>purrr</code>. O primeiro argumento é a estrutura de dados sobre a qual se deseja iterar e o segundo é a função que será aplicada a cada elemento.</p>
<p>O pacote <code>purrr</code> faz parte do <code>tidyverse</code>.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb453-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb453-2" data-line-number="2"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb453-3" data-line-number="3"><span class="kw">map</span>(minha_lista, abs)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 3
## 
## [[3]]
## [1] 5
## 
## [[4]]
## [1] 10</code></pre>
<p>Veja a diferença no output:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" data-line-number="1"><span class="kw">class</span>(minha_lista)</a></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" data-line-number="1"><span class="kw">map</span>(minha_lista, class)</a></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;numeric&quot;
## 
## [[2]]
## [1] &quot;numeric&quot;
## 
## [[3]]
## [1] &quot;numeric&quot;
## 
## [[4]]
## [1] &quot;numeric&quot;</code></pre>
<p>De maneira genérica, é assim que são usados os parâmetros de <code>map()</code>:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" data-line-number="1"><span class="kw">map</span>(.x, .f, ...)</a>
<a class="sourceLine" id="cb459-2" data-line-number="2"><span class="co"># ou </span></a>
<a class="sourceLine" id="cb459-3" data-line-number="3"><span class="kw">map</span>(VETOR_OU_LISTA, FUNCAO_PARA_APLICAR, ARGUMENTOS_OPCIONAIS)</a>
<a class="sourceLine" id="cb459-4" data-line-number="4"><span class="co"># que é equivalente a </span></a>
<a class="sourceLine" id="cb459-5" data-line-number="5">VETOR_OU_LISTA <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map</span>(FUNCAO_PARA_APLICAR, ARGUMENTOS_OPCIONAIS)</a></code></pre></div>
<p>Existem três maneiras de especificar a função para usar no <code>map()</code>:</p>
<ul>
<li>Uma função existente</li>
</ul>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb460-1" data-line-number="1"><span class="co"># definir uma lista composta por vetores</span></a>
<a class="sourceLine" id="cb460-2" data-line-number="2">v &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">v1 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>), <span class="dt">v2 =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>), <span class="dt">v3 =</span> <span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb460-3" data-line-number="3"><span class="co"># aplicar a raiz quadrada a todos os vetores</span></a>
<a class="sourceLine" id="cb460-4" data-line-number="4"><span class="kw">map</span>(v, sqrt)</a></code></pre></div>
<pre><code>## $v1
## [1] 1.000000 1.732051 2.236068
## 
## $v2
## [1] 1.414214 2.000000 2.449490
## 
## $v3
## [1] 2.645751 2.828427 3.000000</code></pre>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb462-1" data-line-number="1"><span class="co"># calcular a soma dos elementos de cada vetor</span></a>
<a class="sourceLine" id="cb462-2" data-line-number="2"><span class="kw">map</span>(v, sum)</a></code></pre></div>
<pre><code>## $v1
## [1] 9
## 
## $v2
## [1] 12
## 
## $v3
## [1] 24</code></pre>
<ul>
<li>Uma função “anônima”, definida dentro da própria <code>map()</code>. Veja que, em <code>function(x)</code> abaixo, <code>x</code> é como se fosse uma representação genérica de cada elemento da lista <code>v</code>. Em inglês isso se chama placeholder.</li>
</ul>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" data-line-number="1"><span class="co"># elevar cada elemento de cada vetor ao quadrado</span></a>
<a class="sourceLine" id="cb464-2" data-line-number="2"><span class="kw">map</span>(v, <span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## $v1
## [1]  1  9 25
## 
## $v2
## [1]  4 16 36
## 
## $v3
## [1] 49 64 81</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb466-1" data-line-number="1"><span class="co"># elevar a soma dos elementos do vetor ao quadrado</span></a>
<a class="sourceLine" id="cb466-2" data-line-number="2"><span class="kw">map</span>(v, <span class="cf">function</span>(x) <span class="kw">sum</span>(x)<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## $v1
## [1] 81
## 
## $v2
## [1] 144
## 
## $v3
## [1] 576</code></pre>
<ul>
<li>Uma fórmula. Deve-se começar com o símbolo <code>~</code> para iniciar uma função e <code>.x</code> para se referir ao seu input, que corresponde a cada elemento da lista especificada no primeiro argumento de <code>map()</code>. Traduzindo os dois comandos anteriores para esta sintaxe, ficaria assim:</li>
</ul>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb468-1" data-line-number="1"><span class="kw">map</span>(v, <span class="op">~</span><span class="st"> </span>.x<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## $v1
## [1]  1  9 25
## 
## $v2
## [1]  4 16 36
## 
## $v3
## [1] 49 64 81</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb470-1" data-line-number="1"><span class="kw">map</span>(v, <span class="op">~</span><span class="st"> </span><span class="kw">sum</span>(.x)<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## $v1
## [1] 81
## 
## $v2
## [1] 144
## 
## $v3
## [1] 576</code></pre>
</div>
<div id="funções-derivadas-de-map" class="section level3">
<h3><span class="header-section-number">11.2.2</span> Funções derivadas de <code>map()</code></h3>
<p>A função <code>map()</code> retorna uma lista. Contudo, se você sabe que sua função deve retornar um resultado em que todos os elementos pertencem a uma mesma classe, é possível usar as funções derivadas de map, como <code>map_chr()</code> (character) e <code>map_dbl()</code> (numérico):</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb472-1" data-line-number="1"><span class="kw">map_chr</span>(v, class)</a></code></pre></div>
<pre><code>##        v1        v2        v3 
## &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb474-1" data-line-number="1"><span class="kw">map_dbl</span>(v, <span class="op">~</span><span class="st"> </span><span class="kw">sum</span>(.x)<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>##  v1  v2  v3 
##  81 144 576</code></pre>
<p>Dá até para garantir que o resultado de <code>map()</code> seja um dataframe com <code>map_dfr()</code> ou <code>map_dfc()</code>:</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb476-1" data-line-number="1"><span class="kw">map_dfc</span>(v, <span class="cf">function</span>(x) x <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##      v1    v2    v3
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     2     4    14
## 2     6     8    16
## 3    10    12    18</code></pre>
<p>É possível e simples encadear uma sequência de comandos <code>map()</code> com o pipe:</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb478-1" data-line-number="1">v <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb478-2" data-line-number="2"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="st"> </span>.x <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb478-3" data-line-number="3"><span class="st">  </span><span class="kw">map_dbl</span>(sum)</a></code></pre></div>
<pre><code>## v1 v2 v3 
## 18 24 48</code></pre>
</div>
</div>
<div id="ideia-de-projeto-aplicando-uma-série-de-funções-a-uma-lista-de-arquivos" class="section level2">
<h2><span class="header-section-number">11.3</span> Ideia de projeto: Aplicando uma série de funções a uma lista de arquivos</h2>
<p>Este <a href="https://www.kaggle.com/robikscube/hourly-energy-consumption#DOM_hourly.csv">dataset no Kaggle</a> traz o consumo médio de energia elétrica por região nos Estados Unidos. A página disponibiliza 13 arquivos csv, um para cada região.</p>
<p>Suponha que, para cada região, desejamos ler o arquivo, padronizar os nomes das duas colunas, acrescentar uma coluna identificando a região do arquivo, calcular o consumo médio por mês do ano e juntar os dataframes. Seria tortuoso fazer isso para cada arquivo manualmente, por isso nos valemos do pacote <code>purrr</code> para sistematizar esse processo.</p>
<p>Baixe o dataset e salve em uma pasta chamada “dados”. Descompacte o arquivo zip e uma nova pasta será criada.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb480-1" data-line-number="1"><span class="co"># listar os arquivos contidos na pasta baixada</span></a>
<a class="sourceLine" id="cb480-2" data-line-number="2">arquivos &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="st">&quot;dados/hourly-energy-consumption/&quot;</span>,</a>
<a class="sourceLine" id="cb480-3" data-line-number="3">                <span class="co"># listar apenas arquivos que contem o padrao abaixo</span></a>
<a class="sourceLine" id="cb480-4" data-line-number="4">                <span class="dt">pattern =</span> <span class="st">&quot;_hourly.csv&quot;</span>,</a>
<a class="sourceLine" id="cb480-5" data-line-number="5">                <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Para fins de demonstração, o código abaixo mostra como seria executar o processo descrito acima para apenas um dos arquivos:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb481-1" data-line-number="1">df1 &lt;-<span class="kw">read_csv</span>(arquivos[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb481-2" data-line-number="2"><span class="kw">head</span>(df1)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   Datetime            AEP_MW
##   &lt;dttm&gt;               &lt;dbl&gt;
## 1 2004-12-31 01:00:00  13478
## 2 2004-12-31 02:00:00  12865
## 3 2004-12-31 03:00:00  12577
## 4 2004-12-31 04:00:00  12517
## 5 2004-12-31 05:00:00  12670
## 6 2004-12-31 06:00:00  13038</code></pre>
<p>Para extrair o nome do arquivo, note que o padrão é NOMEREGIAO_hourly. Por isso, podemos usar str_split() para “quebrar” o string em dois e pegar apenas o primeiro elemento.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb483-1" data-line-number="1"><span class="co"># basename() retorna apenas o nome do arquivo, sem o diretorio</span></a>
<a class="sourceLine" id="cb483-2" data-line-number="2"><span class="kw">basename</span>(arquivos[<span class="dv">1</span>])</a></code></pre></div>
<pre><code>## [1] &quot;AEP_hourly.csv&quot;</code></pre>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb485-1" data-line-number="1"><span class="co"># str_split() quebra um string em mais de um baseado no separador especificado</span></a>
<a class="sourceLine" id="cb485-2" data-line-number="2">nome_regiao &lt;-<span class="st"> </span><span class="kw">str_split</span>(<span class="kw">basename</span>(arquivos[<span class="dv">1</span>]), <span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb485-3" data-line-number="3"></a>
<a class="sourceLine" id="cb485-4" data-line-number="4"></a>
<a class="sourceLine" id="cb485-5" data-line-number="5">df1_mes &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb485-6" data-line-number="6"><span class="st">  </span><span class="co"># mudar nome das colunas</span></a>
<a class="sourceLine" id="cb485-7" data-line-number="7"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">set_names</span>(<span class="kw">c</span>(<span class="st">&quot;horario&quot;</span>, <span class="st">&quot;consumo&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb485-8" data-line-number="8"><span class="st">  </span><span class="co"># criar uma coluna contendo o mes da data</span></a>
<a class="sourceLine" id="cb485-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mes =</span> lubridate<span class="op">::</span><span class="kw">month</span>(horario)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb485-10" data-line-number="10"><span class="st">  </span><span class="co"># criar uma coluna contendo o nome da regiao do arquivo</span></a>
<a class="sourceLine" id="cb485-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">regiao =</span> nome_regiao) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb485-12" data-line-number="12"><span class="st">  </span><span class="co"># agrupar os dados e calcular a media</span></a>
<a class="sourceLine" id="cb485-13" data-line-number="13"><span class="st">  </span><span class="kw">group_by</span>(regiao, mes) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb485-14" data-line-number="14"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">consumo_medio =</span> <span class="kw">mean</span>(consumo))</a>
<a class="sourceLine" id="cb485-15" data-line-number="15"></a>
<a class="sourceLine" id="cb485-16" data-line-number="16"></a>
<a class="sourceLine" id="cb485-17" data-line-number="17">df1_mes</a></code></pre></div>
<pre><code>## # A tibble: 12 x 3
## # Groups:   regiao [1]
##    regiao   mes consumo_medio
##    &lt;chr&gt;  &lt;dbl&gt;         &lt;dbl&gt;
##  1 AEP        1        17431.
##  2 AEP        2        17023.
##  3 AEP        3        15377.
##  4 AEP        4        13824.
##  5 AEP        5        14006.
##  6 AEP        6        15630.
##  7 AEP        7        16350.
##  8 AEP        8        16425.
##  9 AEP        9        14657.
## 10 AEP       10        13939.
## 11 AEP       11        14930.
## 12 AEP       12        16446.</code></pre>
<p>A solução para aplicar o código acima para todos os arquivos csv diferentes de maneira elegante no R é o sistematizar, transformando-o em uma função:</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb487-1" data-line-number="1">agregar_dados &lt;-<span class="st"> </span><span class="cf">function</span>(arquivo_csv){</a>
<a class="sourceLine" id="cb487-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb487-3" data-line-number="3">  <span class="co"># str_split() quebra um string em mais de um baseado no separador especificado</span></a>
<a class="sourceLine" id="cb487-4" data-line-number="4">  nome_regiao &lt;-<span class="st"> </span><span class="kw">str_split</span>(<span class="kw">basename</span>(arquivo_csv), <span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb487-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb487-6" data-line-number="6">  <span class="co"># ler arquivo para um dataframe</span></a>
<a class="sourceLine" id="cb487-7" data-line-number="7">  dframe &lt;-<span class="st"> </span><span class="kw">read_csv</span>(arquivo_csv)</a>
<a class="sourceLine" id="cb487-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb487-9" data-line-number="9">  <span class="co"># criar novo dataframe</span></a>
<a class="sourceLine" id="cb487-10" data-line-number="10">  dframe_mes &lt;-<span class="st"> </span>dframe <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb487-11" data-line-number="11"><span class="st">    </span><span class="co"># mudar nome das colunas</span></a>
<a class="sourceLine" id="cb487-12" data-line-number="12"><span class="st">    </span>purrr<span class="op">::</span><span class="kw">set_names</span>(<span class="kw">c</span>(<span class="st">&quot;horario&quot;</span>, <span class="st">&quot;consumo&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb487-13" data-line-number="13"><span class="st">    </span><span class="co"># criar uma coluna contendo o mes da data</span></a>
<a class="sourceLine" id="cb487-14" data-line-number="14"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">mes =</span> lubridate<span class="op">::</span><span class="kw">month</span>(horario)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb487-15" data-line-number="15"><span class="st">    </span><span class="co"># criar uma coluna contendo o nome da regiao do arquivo</span></a>
<a class="sourceLine" id="cb487-16" data-line-number="16"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">regiao =</span> nome_regiao) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb487-17" data-line-number="17"><span class="st">    </span><span class="co"># agrupar os dados e calcular a media</span></a>
<a class="sourceLine" id="cb487-18" data-line-number="18"><span class="st">    </span><span class="kw">group_by</span>(regiao, mes) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb487-19" data-line-number="19"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">consumo_medio =</span> <span class="kw">mean</span>(consumo))</a>
<a class="sourceLine" id="cb487-20" data-line-number="20">  </a>
<a class="sourceLine" id="cb487-21" data-line-number="21">  <span class="co"># retornar novo dataframe</span></a>
<a class="sourceLine" id="cb487-22" data-line-number="22">  dframe_mes</a>
<a class="sourceLine" id="cb487-23" data-line-number="23"></a>
<a class="sourceLine" id="cb487-24" data-line-number="24">}</a></code></pre></div>
<p>Como sabemos que a função <code>agregar_dados()</code> deve retornar um dataframe, usamos <code>map_dfr()</code> para, além de gerar um dataframe por arquivo, juntá-los em um dataframe só:</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb488-1" data-line-number="1">df_mes_geral &lt;-<span class="st"> </span>arquivos <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb488-2" data-line-number="2"><span class="st">  </span><span class="kw">map_dfr</span>(agregar_dados)</a>
<a class="sourceLine" id="cb488-3" data-line-number="3"></a>
<a class="sourceLine" id="cb488-4" data-line-number="4"></a>
<a class="sourceLine" id="cb488-5" data-line-number="5"><span class="kw">head</span>(df_mes_geral)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
## # Groups:   regiao [1]
##   regiao   mes consumo_medio
##   &lt;chr&gt;  &lt;dbl&gt;         &lt;dbl&gt;
## 1 AEP        1        17431.
## 2 AEP        2        17023.
## 3 AEP        3        15377.
## 4 AEP        4        13824.
## 5 AEP        5        14006.
## 6 AEP        6        15630.</code></pre>
</div>
<div id="referências" class="section level2">
<h2><span class="header-section-number">11.4</span> Referências</h2>
<p><a href="https://jennybc.github.io/purrr-tutorial/index.html">Tutorial da Jenny Brian sobre purrr</a><br />
<a href="https://lente.dev/posts/magica-purrr/">Tutorial completo do Caio Lente sobre purrr em português</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="obtendo-dados.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cdr-intro.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
